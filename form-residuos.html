<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Formulario Agua</title>
<style>
body { font-family: Arial; padding:20px; max-width:600px; margin:auto; }
input, textarea { width:100%; padding:8px; margin:8px 0; }
button { padding:10px; cursor:pointer; }
</style>
</head>
<body>

<h2>Formulario ‚Äî Agua</h2>
<p>Rellene los datos solicitados:</p>

<label>Poblaci√≥n abastecida:</label>
<input name="poblacion" placeholder="habitantes">

<label>Longitud de red:</label>
<input name="longitud" placeholder="metros">

<label>Observaciones:</label>
<textarea name="obs"></textarea>

<button onclick="guardar()">üíæ Guardar datos</button>
<button onclick="location.href='menu.html'">‚¨ÖÔ∏è Volver</button>

<script>
if(!sessionStorage.getItem('usuario')) location.href="index.html";

// ‚úÖ Guardar datos
function guardar() {
    const usuario = sessionStorage.getItem('usuario');
    const modulo = window.location.pathname.split('/').pop().replace('.html','');
    const datos = {};
    document.querySelectorAll("input, textarea").forEach(el => datos[el.name] = el.value);

    localStorage.setItem(usuario + "_" + modulo, JSON.stringify(datos));
    marcarCompleto(modulo);
    alert("‚úÖ Datos guardados");
}

function marcarCompleto(modulo) {
    let e = JSON.parse(localStorage.getItem("estado_" + sessionStorage.getItem('usuario'))) || {};
    e[modulo] = "completo";
    localStorage.setItem("estado_" + sessionStorage.getItem('usuario'), JSON.stringify(e));
}
</script>

</body>
</html>
