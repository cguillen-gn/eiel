<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EIEL 2026 - Acceso</title>
<link rel="stylesheet" href="css/style.css"> 
<script src="https://cdn.tailwindcss.com"></script>
<style>
/* Estilos index */
html, body { height: 100%; margin: 0; background-color: #f1f5f9; font-family: 'Inter', sans-serif; }
body { display: flex; align-items: center; justify-content: center; }

.panel { 
    background: white; border-radius: 16px; 
    box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1); 
    max-width: 480px; width: 90%; overflow: hidden; position: relative;
    min-height: 450px;
}
.panel-header { background-color: var(--primary); padding: 2.5rem 1.5rem; color: white; text-align: center; }
.panel-header h1 { margin: 0; font-size: 2rem; font-weight: 700; }

/* Login Form */
.form-section { padding: 2rem; }
label { display: block; font-weight: 600; margin-bottom: 0.5rem; color: #334155; }
.input-field { 
    width: 100%; padding: 0.9rem; border: 1px solid #cbd5e1; border-radius: 8px; font-size: 1rem; margin-bottom: 1.5rem; background: white;
}
.input-field:focus { outline: none; border-color: var(--primary); ring: 2px var(--primary); }

.btn-entrar {
    width: 100%; padding: 1rem; background-color: var(--primary); color: white; 
    font-weight: 700; border-radius: 8px; border: none; cursor: pointer; font-size: 1.1rem;
    transition: background 0.2s;
}
.btn-entrar:hover { background-color: var(--primary-hover); }

/* Menú */
.menu-header { text-align: center; padding-bottom: 1.5rem; border-bottom: 1px solid #e2e8f0; margin-bottom: 1.5rem; }
.muni-badge { background: #f1f5f9; color: var(--primary); padding: 0.5rem 1rem; border-radius: 99px; font-weight: 600; display: inline-block; margin-bottom: 0.5rem; }
.muni-title { font-size: 1.5rem; font-weight: 700; color: #1e293b; }

.btn-grid { display: flex; flex-direction: column; gap: 0.8rem; }
.btn-menu { 
    display: flex; align-items: center; padding: 1.2rem; font-weight: 600; 
    border-radius: 8px; text-decoration: none; color: #334155; 
    background-color: white; border: 1px solid #e2e8f0; border-left-width: 6px; 
    transition: all 0.2s; box-shadow: 0 2px 4px rgba(0,0,0,0.05);
}
.btn-menu:hover { transform: translateX(5px); background-color: #f8fafc; }

/* Colores */
.b-agua { border-left-color: var(--theme-agua); }
.b-obras { border-left-color: var(--theme-obras); }
.b-residuos { border-left-color: var(--theme-residuos); }
.b-cementerios { border-left-color: var(--theme-cementerios); }

.error-msg { color: #ef4444; text-align: center; margin-top: 1rem; font-weight: 600; display: none; }
.hidden { display: none !important; }
</style>
</head>
<body>

<div class="panel">
    <div class="panel-header">
        <h1>EIEL 2026</h1>
        <p>Portal de Recogida de Datos</p>
    </div>

    <div id="viewLogin" class="form-section">
        <label>1. Seleccione su Municipio</label>
        <select id="muniSelect" class="input-field">
            <option value="">-- Buscar en la lista --</option>
            </select>

        <label>2. Código de Acceso</label>
        <input type="password" id="muniCode" class="input-field" placeholder="Introduzca el código facilitado">

        <button id="btnLogin" class="btn-entrar">Entrar</button>
        <p id="errorMsg" class="error-msg">Código incorrecto</p>
    </div>

    <div id="viewMenu" class="form-section hidden">
        <div class="menu-header">
            <span class="muni-badge" id="muniCodeDisplay">000</span>
            <h2 class="muni-title" id="muniNameDisplay">Municipio</h2>
        </div>

        <div class="btn-grid">
            <a id="lnkAgua" href="#" class="btn-menu b-agua">💧 Abastecimiento de Agua</a>
            <a id="lnkObras" href="#" class="btn-menu b-obras">🏗️ Obras y Actuaciones</a>
            <a id="lnkResiduos" href="#" class="btn-menu b-residuos">♻️ Residuos y Limpieza</a>
            <a id="lnkCementerios" href="#" class="btn-menu b-cementerios">⚰️ Cementerios</a>
        </div>

        <button onclick="logout()" style="margin-top: 2rem; width: 100%; color: #94a3b8; background: none; border: none; cursor: pointer; text-decoration: underline;">Cerrar Sesión</button>
    </div>
</div>

<script>
    // DATOS DE PYTHON
    const MUNICIPIOS = [{"code": "001", "name": "Adsubia"}, {"code": "002", "name": "Agost"}, {"code": "003", "name": "Agres"}, {"code": "004", "name": "Aigües"}, {"code": "005", "name": "Albatera"}, {"code": "006", "name": "Alcalalí"}, {"code": "008", "name": "Alcoleja"}, {"code": "007", "name": "Alcosser"}, {"code": "009", "name": "Alcoy/Alcoi"}, {"code": "010", "name": "Alfafara"}, {"code": "011", "name": "Alfàs del Pi (l')"}, {"code": "012", "name": "Algorfa"}, {"code": "013", "name": "Algueña"}, {"code": "014", "name": "Alicante/Alacant"}, {"code": "015", "name": "Almoradí"}, {"code": "016", "name": "Almudaina"}, {"code": "017", "name": "Alqueria d'Asnar (l')"}, {"code": "018", "name": "Altea"}, {"code": "019", "name": "Aspe"}, {"code": "020", "name": "Balones"}, {"code": "021", "name": "Banyeres de Mariola"}, {"code": "022", "name": "Benasau"}, {"code": "023", "name": "Beneixama"}, {"code": "024", "name": "Benejúzar"}, {"code": "025", "name": "Benferri"}, {"code": "026", "name": "Beniarbeig"}, {"code": "027", "name": "Beniardà"}, {"code": "028", "name": "Beniarrés"}, {"code": "030", "name": "Benidoleig"}, {"code": "031", "name": "Benidorm"}, {"code": "032", "name": "Benifallim"}, {"code": "033", "name": "Benifato"}, {"code": "029", "name": "Benigembla"}, {"code": "034", "name": "Benijófar"}, {"code": "035", "name": "Benilloba"}, {"code": "036", "name": "Benillup"}, {"code": "037", "name": "Benimantell"}, {"code": "038", "name": "Benimarfull"}, {"code": "039", "name": "Benimassot"}, {"code": "040", "name": "Benimeli"}, {"code": "041", "name": "Benissa"}, {"code": "042", "name": "Benitachell/Poble Nou de Benitatxell (el)"}, {"code": "043", "name": "Biar"}, {"code": "044", "name": "Bigastro"}, {"code": "045", "name": "Bolulla"}, {"code": "046", "name": "Busot"}, {"code": "048", "name": "Callosa d'En Sarrià"}, {"code": "049", "name": "Callosa de Segura"}, {"code": "047", "name": "Calp"}, {"code": "050", "name": "Campello (el)"}, {"code": "051", "name": "Campo de Mirra/Camp de Mirra (el)"}, {"code": "053", "name": "Castalla"}, {"code": "054", "name": "Castell de Castells"}, {"code": "075", "name": "Castell de Guadalest (el)"}, {"code": "055", "name": "Catral"}, {"code": "052", "name": "Cañada"}, {"code": "056", "name": "Cocentaina"}, {"code": "057", "name": "Confrides"}, {"code": "058", "name": "Cox"}, {"code": "059", "name": "Crevillent"}, {"code": "061", "name": "Daya Nueva"}, {"code": "062", "name": "Daya Vieja"}, {"code": "064", "name": "Dolores"}, {"code": "063", "name": "Dénia"}, {"code": "065", "name": "Elche/Elx"}, {"code": "066", "name": "Elda"}, {"code": "067", "name": "Facheca"}, {"code": "068", "name": "Famorca"}, {"code": "069", "name": "Finestrat"}, {"code": "077", "name": "Fondo de les Neus (El)/Hondon de las Nieves"}, {"code": "070", "name": "Formentera del Segura"}, {"code": "072", "name": "Gaianes"}, {"code": "071", "name": "Gata de Gorgos"}, {"code": "073", "name": "Gorga"}, {"code": "074", "name": "Granja de Rocamora"}, {"code": "076", "name": "Guardamar del Segura"}, {"code": "078", "name": "Hondón de los Frailes"}, {"code": "079", "name": "Ibi"}, {"code": "080", "name": "Jacarilla"}, {"code": "083", "name": "Jijona/Xixona"}, {"code": "082", "name": "Jávea/Xàbia"}, {"code": "085", "name": "Llíber"}, {"code": "084", "name": "Lorcha/L'Orxa"}, {"code": "086", "name": "Millena"}, {"code": "088", "name": "Monforte del Cid"}, {"code": "903", "name": "Montesinos (Los)"}, {"code": "089", "name": "Monóvar/Monòver"}, {"code": "091", "name": "Murla"}, {"code": "092", "name": "Muro de Alcoy"}, {"code": "090", "name": "Mutxamel"}, {"code": "093", "name": "Novelda"}, {"code": "094", "name": "Nucia (la)"}, {"code": "095", "name": "Ondara"}, {"code": "096", "name": "Onil"}, {"code": "097", "name": "Orba"}, {"code": "099", "name": "Orihuela"}, {"code": "098", "name": "Orxeta"}, {"code": "100", "name": "Parcent"}, {"code": "101", "name": "Pedreguer"}, {"code": "102", "name": "Pego"}, {"code": "103", "name": "Penàguila"}, {"code": "104", "name": "Petrer"}, {"code": "902", "name": "Pilar de la Horadada"}, {"code": "105", "name": "Pinos (El)/Pinoso"}, {"code": "106", "name": "Planes"}, {"code": "901", "name": "Poblets (els)"}, {"code": "107", "name": "Polop"}, {"code": "060", "name": "Quatretondeta"}, {"code": "109", "name": "Rafal"}, {"code": "111", "name": "Redován"}, {"code": "112", "name": "Relleu"}, {"code": "113", "name": "Rojales"}, {"code": "114", "name": "Romana (la)"}, {"code": "110", "name": "Ràfol d'Almúnia (El)"}, {"code": "115", "name": "Sagra"}, {"code": "116", "name": "Salinas"}, {"code": "118", "name": "San Fulgencio"}, {"code": "904", "name": "San Isidro"}, {"code": "120", "name": "San Miguel de Salinas"}, {"code": "122", "name": "San Vicente del Raspeig/Sant Vicent del Raspeig"}, {"code": "117", "name": "Sanet y Negrals"}, {"code": "119", "name": "Sant Joan d'Alacant"}, {"code": "121", "name": "Santa Pola"}, {"code": "123", "name": "Sax"}, {"code": "124", "name": "Sella"}, {"code": "125", "name": "Senija"}, {"code": "128", "name": "Teulada"}, {"code": "129", "name": "Tibi"}, {"code": "130", "name": "Tollos"}, {"code": "131", "name": "Tormos"}, {"code": "132", "name": "Torremanzanas/Torre de les Maçanes (la)"}, {"code": "133", "name": "Torrevieja"}, {"code": "127", "name": "Tàrbena"}, {"code": "134", "name": "Vall d'Alcalà (la)"}, {"code": "135", "name": "Vall d'Ebo (la)"}, {"code": "136", "name": "Vall de Gallinera (la)"}, {"code": "137", "name": "Vall de Laguar (la)"}, {"code": "138", "name": "Verger (el)"}, {"code": "139", "name": "Villajoyosa/Vila Joiosa (la)"}, {"code": "140", "name": "Villena"}, {"code": "081", "name": "Xaló"}]; 
    const AUTH_HASHES = {"001": "8f8d7ed7a8545611bf296120bf479b86391336d175cd7c1abcb297bee51e9769", "002": "89e192be3fee1ace1847edbf1348fcf68e6ebb84cda3e72fdbaeb3afbf9d8405", "003": "d4cbaca2e87bad3e558ce2c119f6229e2e463265e153e16d5f4d01c2942992f8", "004": "e4c528d7592f0e140e2181fb60c423db9100338c4fe4098fcfaa2b054403a60d", "005": "0d085af45b8c52a0392548308f402dcab8eb894c7280d30d35b86f1ab3e0f5dc", "006": "fe5b2c38a74f2677a8c210e7b367408d8b19609124c8a93c28f1d5edbcdc9652", "007": "58a6a7d5741fefafae76337d70fe6a8f54de675bb01b8a04eff253f86976f01c", "008": "140602259d1c9d27bc60b84c5c1e7adcfab59668c737952b88ffd5a82f1401cc", "009": "75e7efcf53679bc537a5618054ef74e5387eea648302accd84101c89916cb1b3", "010": "6c2ca12787669ecf02dbd69056a3d4766237af555d5af18a98862e4a88f04514", "011": "40fa1b784dc1af32dc8a4071f86f55cc2adc715fc792ba60282e67c4fbfe8c85", "012": "f159adb43b47f2bf7ce9b0f07d7a250d15d761c0aebc67fda2dbf92dd0fc5cd0", "013": "3ba7fc3686056b5cbd3fe386d84205529c3810450013d36481bd5a38a0f34455", "014": "799842c3e2c19351a68c15ddc096a97615957edb9e1886b0643578f81eaa8403", "015": "8ddf29c2b8074e02f1f5e2c5d543bb1c98fd001f43afeedb0ad6323bc69b3adf", "016": "7475240d806082fb3c74a44cb6a16d71ef7945560b1bf3e150b2ab3412d99bc2", "017": "550c1a70127091df80c6eabf6c39933a1de3237ab945a76eefa6235b9a2794bb", "018": "5f9850608e66ca619ca1cdbd59dc9afed3d34ce8c23e9a8650de641712ef832c", "019": "039247d516463df68bd389959e3f91a46245caf3f04d70bf0b1564d13d8b5914", "020": "6e9d5c91d833be72c5c87b2f157afe01d9d89fa222ba608353d14a49bc8a2c25", "021": "ceb8e75bb75e15705fa466bbf73989ef58b50db6ee7264cd3b2bbc96236db52a", "022": "ebf0eff300bb33a7fa18f349f99b0a7539180114a09adefd562e3a31b8bbab74", "023": "d33c67589bd46027b85d713b5748fcc1343105223794c70b040465fb742e5898", "024": "8009aaf88d8b89e97b8f4a01b54c993ab8a65738a60131d0a5ad6fbb1f39cee3", "025": "32d25c65c5a80c72e8632e09ad7e6a327426b8164446b2461227c9e1467d985c", "026": "4a4b853c12fb3ca66479653e637cb1c6d5d7db3ce8c61abe7ef6f25d3450b50b", "027": "63ddb61aadbb3c0c35b09ab7ee25f28e62271ca1729890a069661697c5931b2d", "028": "35a9e6086d31bbe1f981ac065c5e6262571ed21f6b066b84f6675c844be9b97a", "029": "711feac66f1c64554bf5ea2ad09944b45ffe0e0411b4e29818da0c0df281c070", "030": "af77c3aa020f831cfe54868073629956362272f5cdb35785daf8a430cb75c556", "031": "07cfc768996f2725c9ed06801d33d93b5087c78118426aafa0fb67cc0acbf3f8", "032": "995c2253fa56b5729d2738e3c002ba4a72efa7f2cc3e1872b026212f9cf81685", "033": "05857d18a143d4d8c679dabd3e5dbedacfc5fe1d277d610cbbf7f6664204189d", "034": "c054e29ba8994ebe92e2e37dc4a8dbfcb55cb4ab0f8e25dbdb157055f82aa78d", "035": "be6e382ae9fd395095c060ce5907e2b0c7b69f727c04d2f424d283cbbe03f651", "036": "e1e9b94fe34218df1ecb4519ea6990dc83029af4e127ff07993eb95fa97b3358", "037": "b7026207ee45a89eb1ed575cbb5a6aa93caa4c41f536cf6f0b31f9f222200836", "038": "69fbc39c14a018675c55da6262a0db6335beb314cb29499e6fab3a345327adae", "039": "8cf21d6f1e1d2fef0e90379c980badf1feb1c46e04d9c7d50e87168f4e23a924", "040": "48cab3eca60a31a8d867edb40626885a98d2ab72be7de7a3b84e91d903e51670", "041": "0acf6b29416cffee4953cee86c91185dc949f1f173e1c9e1b19e88d7da1e5ce9", "042": "00f42098311a443d6a5fecd773d82637caed5cb697250565e13b0cec8e0134f7", "043": "29e44e52b4949d99e73d50007f7df78820063a78ea73c02a13f51769a7a4b411", "044": "2e3d93860e121349e9798edfa3e6c7302d687a46fd6b3efe07edb5da96e13d2d", "045": "7303f949b6843480b25d6eaa7fe90657092183de40ab2cc9bac0f000bbfe902d", "046": "a189fd54a203f35864ebe64b2884a11f3f53eda289fd08dc3a12232426829ef6", "047": "65fcb57005edd45e55da977cdbd7ed3bfe90ef5afd264d55b4b47f615ec109a5", "048": "7872d802063926f698b8f8cc07673aa9eed2d201b3c4dfa22856ecfd1e407275", "049": "f3f134944ef997ef36a91f88358950cae7763582cbebae15ef38fb1b5f8f8284", "050": "7b64858b6ae178577e137d7038ae98e249cb9403c282b542873c516ae9e8cac8", "051": "2c92fa69c8f298d3b2effadcbb6bb91816a978244b3974d3c633808ca050482f", "052": "347bfab10b5cf064aa180c7ded071c6b1a2208bfc820c2fa3aecc8019ea6791d", "053": "bfea393754e5a8a761a8eac544777b092e648127622e178faaf94a7d5f6be532", "054": "ce5de6eea4581ccd4bd3e2fd935d1046f7dfb0d5c4c0c0bd5219527ddbf09892", "055": "f0bd74af108cde24fef5ba200c0eb534a65b5ba6410f59eee23b56753eb03ca6", "056": "27705dcfab6dae57061e70a4164f447b05dd46d69a5241dd5638bbc50b6c7158", "057": "5a479cc0148bf42313a257b5724d2cff59512394cf5dd8b62619ef3cd4421315", "058": "3fd88cde262995cfdb909f513468d74455182dcedf7ee306d50f7584ddd224e5", "059": "bc915465e02995939c6d7b16c3f28e7fd56967722750fa0087789c23a3ab4dea", "060": "ea57bfd8f7becff3c96cc5e42e1eb717f894a5177b5703599ffa8e201898ddb7", "061": "787571b51a28d4ced17f567fe66f9fa9a89c98e08e0138e61a832399b3cd7db7", "062": "d3ddd8b4f8d837fe2ba583c694aab83f1375c50420914615afbcdf0ca0f7d483", "063": "8693c26732621c346a5cc4d3bcf84136de2074e310e632178b58e5bd270300d2", "064": "23d8e25826637d98494e12491ee0b552092eb3bd8958fa832ecfd63d12fb2f2f", "065": "8a05e76e8363cb33760cf6adf8f70dfe081a7580762ba94352f4a51d847247b7", "066": "cdf04d8d2e33d579fe340a8d71baeb526bc09af0d362fcb62d2dec85a6733634", "067": "8c48d5905d1531f4f595e4a302f459bded7f7241c8c66ed45100809464bf1f71", "068": "ecbe879d6bde3d39bd2833a9365986c9d6f1a22288aa31aa0717a71444594c75", "069": "62a9f1d7fbe0a725bdd3ad1f2fdc511b6105664800f0c98cdee5af01376f63b6", "070": "d962418dec5a14c2d60211ce34b8678ef828044044a8ca7f43d0dc712dd5c66b", "071": "3c9c6b5a557ca5408f2f31c4d3ffee41f8c658513285afcf38fcee512159cfd5", "072": "e9c7fd6e1a3fd565a83cc38e36e992c87aff771a303ac8b249001f16069f98aa", "073": "54160e71c4d0a820dc218a0bc12b245aada8deed82c7c588e1a9a48a84379627", "074": "d83b69070fcc29b981bc7694e183639182fd21ccaddc15953743a441393d7f0e", "075": "75d61bf3e5131ed72ef4d312c424dbc1f0cc28ba791314c20fb7f4a237ed3298", "076": "b268562141511058c189f48f9dc74317474c6bb0f7fd476abbc96ad3fc1fb7e6", "077": "540d0a4e3d050c42293a2cb8ef3caadf70678e3e926d99ab594ebbe1b55345b7", "078": "15aaaffd05a3430db0570d1a8a9a7adfc9de0d2e59f4b48a4104064a2c10f078", "079": "91bcc1e289d8796551204bb729a620df1b60452b337800d0e4205aa8f16121a1", "080": "76c9017cb18bd58f920d32ac7f7ab353d6f729df0d0c4e642c6ab9f35814dbc0", "081": "6a7be9816d1072c438070f4b45c6b28f49bf2470c81841c638cece8504199803", "082": "2acdb6e3dc89f12db215b1793990cbc4332ceb52789dbb73f287ad21975387f7", "083": "1db301351d961e731f43b56366fe0350e45bbf25631de5bd207c52431449490f", "084": "ed34a804f58047f113956cfdaf5cea6ce18b9a0a498918664bd3ac71e1c31652", "085": "b1ba5583b93a9d3bdf575e4c9e823cfdb2453c9202e52f6fdf7358f7bebae556", "086": "3dc4cae8f4db91a915db90b36519ec06b3620cc51a44c1971462602a440ae04b", "088": "190e287b3fb1200dc755019263ca988135e51844252a765ad110c13227278169", "089": "5ad3316336ad178339d3aec641e735109ab9bcdd9756ffa3fb9124cd7a721235", "090": "f394778e78eabd42b3f05fe1ee841a1ffff7fea4f049ee02478bbf3f433fc732", "091": "baac01fd9a4e65a213e00696bf9988981e065e6a5f8885b7238d54118c46b94b", "092": "f44405e2731163ab9cbd5613637d5a5524b34cdc74b61d925696108fc73f3508", "093": "d9911f8efb878132c56d1bb737f233a2035d5c4d6b6bc6251054878af5eff963", "094": "c32cbc112b831e7a506e2e419add1a195907c6c438171aa4bf4d990dfb8ee3c1", "095": "799b57531a197b71c0b2955dc5aff33c4816c4bdfbde70bdec19c954726d21ac", "096": "5be61c23ba393337a7331732b0b7162772bc44eb72c74fa0d6a592f5b694babf", "097": "f8edb9d5584f0e32dcf121edca2afbbcf87094e6023ed4a42deafc1b3eb2bf8a", "098": "05ac8f6e70e7d59575fc5ca5e9e06c823c34ec73af3cfbd84ed77f719f5217d3", "099": "a9a1a94ca4811a694a4915a9ab68483387643459dabc88703e54a070a21969b9", "100": "eab6e8f853022a5db7714d78996fb3ef90dfdd3664714a85d42a40629d6761ed", "101": "16e724108c700d8d3afbac4e2b028959bd01bc51ba7f9d25f8b8fb1bc9cbabff", "102": "27cb6c8fc7d5833cadb1cbbb3e2673df4898d430ae4ddc19b650ba65eefe3897", "103": "74c02a9de57151c2ee9e4e872f54f5352279c9b3bf7a2836bb4c8a8e3bd12fe3", "104": "8d6a3aa13a7109f4ae9399971b50fbaec11c0839a1180d5aa6a3cf7c3dad9473", "105": "c4a8e1daae5b090346269c89ce15843c7f3c7fc5fd212d3808842339148b151c", "106": "8272d9f2219723e785c82887513f3640fdd6e878ceb7817728a05bafbc67a6e2", "107": "bd44d8bfb585883be94263d1f8963c35ef39629c839bed8aa01b8535afc603a6", "109": "cf71880d4ae8cba15ce12a6c686ee492544d2a54f07cff32371e0461ddac57b7", "110": "939382502c568bc29a2d997cd4c5d3eeddb4886f336f7a48828cfd50dd8b215c", "111": "e930e62dfa1a25e5f352fa7eac00dba53474cc25f60a69870b77d066a3512b99", "112": "1a50d5ceb3dab5d5c340345f91ae154351a0538b7cc3dc9955eeed2c1a135209", "113": "5d0844e3dd17b8354d3051b1dee1f6f38f65b44a28648d8ad04c6d9224872a8b", "114": "48909f14ae39b0704ef04f8079d0ed9b8fa9bb57fdb48bc71187fdc835849684", "115": "351612f70cf11040314b1cca3aa1473c7b3afb2162d97f40fd4d68fb3ee08af9", "116": "01558c7ef103fe4fe2be8f31ee24cad4b588e42a09b0e3cb7c3de9fcc0ebd36c", "117": "ff81a22ac7a62fbba5bd323c2e18cec049603047cb64f7900f65e66e09e78fc1", "118": "5db067c37e876e6e3ca12c6665c2ccbbb0fc3641867538bcdb5b600539423389", "119": "f44b2661e06bf0c94ba1e4f7669b528e56cb8b7936c00b459965c6860b01a44e", "120": "d33c3d6d7609c1805df191250f076d7649883b88534f0978b6b55bf02c3bacf8", "121": "8ad91a8054ed723c7c1110701bc1442614b5d4893db27dc87f87a9b81a1fdc23", "122": "da2bedd1af8f1fd9180e9af4226f4fc13beed678b747bf95153b80b99bb320ff", "123": "b4d2b420224b014f9cb6c139a2af903791b0ef4b368ed472b1eccaa53aa857af", "124": "dba1218c79a159c894e58d44a856fb5223855339c90636446e4002f20b33fcb9", "125": "b9b1a66017f65d04ce506eb1d62b92a62443d64b9b5923042d3efa8e9dbe3d43", "127": "a58774448040263502d39b042bc505ed21f49d97f314b591a09b225422ef3aa6", "128": "3247365bc2a93fc0896bc2737a77192c601853c58d81ecaff8c30feb0cf8deb1", "129": "79acbd9a1e0f539e4eef0353358fde5233531c14f27da32f11d3fcd0469a953c", "130": "24de866c068dac913fdd3254ab1be222d5161aff5939d6dc3ff29d22314a2e72", "131": "8affdd013ecf067c0447b137e3846b151d367084550836a06feafe0e8b066b30", "132": "0c25bd4532adafbe6b918eae67794bde354a806a010e9c1471ab2b5c5ec0aa6d", "133": "a0b477434b470fcca26b3197fd2f833981140cb3b5bfc5057b8a47404aa252cf", "134": "2156dfdb04e22bdd344c4b3d578710bc87ff2b8779e1e8f03721e5b3801f5255", "135": "2907e1328537aee29261fe11edafb7c4873f158a95f6668743bacbd0d22583cc", "136": "f668db79b2230894f7780cec63cabca97b1e6b221ed476be5940f5a0d4028f4b", "137": "abb99b2875a8447dc2405c35da926ae391d3ffb1b76a4d7c605c2bf860dffb22", "138": "c4a5ad4aa6a5458ee86b960ba9ef71a4216096585c54f87cb6da89e6d5daa5ac", "139": "13818bf4f2ff113c0b1e8a376fa10f6f4370e296a14abdea1c0387a6bfb98709", "140": "67abe6552d96d1231d3dfbafccc273336fb4012e220fd9ad5c5fef5d952cadc9", "901": "9ea2e10ef38884188fbb8872f6090f3d4d80c9856bcb6e8a4be00998b096c766", "902": "6aa28dfb2ca51176d9120a133c8943df08ca7125177c3f92b9cb0ef371baddcc", "903": "53c5a5d32147c8d7cccbe59ebd238df458aa858e8c20341a4032f6361f42a55a", "904": "e109860b99e1d70cf0ad3df476d51027943d8e709a5a2be134907c1108e3967e"}; 

    // Referencias UI
    const ui = {
        login: document.getElementById('viewLogin'),
        menu: document.getElementById('viewMenu'),
        select: document.getElementById('muniSelect'),
        input: document.getElementById('muniCode'),
        btn: document.getElementById('btnLogin'),
        error: document.getElementById('errorMsg'),
        name: document.getElementById('muniNameDisplay'),
        code: document.getElementById('muniCodeDisplay'),
        links: {
            agua: document.getElementById('lnkAgua'),
            obras: document.getElementById('lnkObras'),
            residuos: document.getElementById('lnkResiduos'),
            cementerios: document.getElementById('lnkCementerios')
        }
    };

    // 1. Llenar Select
    MUNICIPIOS.forEach(m => {
        const opt = document.createElement('option');
        opt.value = m.code;
        opt.textContent = `${m.name} (${m.code})`;
        ui.select.appendChild(opt);
    });

    // 2. Función Hash SHA-256 (Nativa navegador)
    async function sha256(message) {
        const msgBuffer = new TextEncoder().encode(message);
        const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer);
        const hashArray = Array.from(new Uint8Array(hashBuffer));
        return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
    }

    // 3. Login
    ui.btn.addEventListener('click', async () => {
        const selectedCode = ui.select.value;
        const enteredPass = ui.input.value.trim();

        if(!selectedCode || !enteredPass) {
            showError("Seleccione un municipio e introduzca el código.");
            return;
        }

        // Validar
        const trueHash = AUTH_HASHES[selectedCode]; // Hash real del municipio
        const inputHash = await sha256(enteredPass); // Hash de lo que ha escrito el usuario

        if (trueHash === inputHash) {
            // ÉXITO
            const muniName = ui.select.options[ui.select.selectedIndex].text.split('(')[0].trim();
            loginSuccess(selectedCode, muniName);
        } else {
            // ERROR
            showError("Código de acceso incorrecto.");
        }
    });

    // 4. Gestión Sesión
    function loginSuccess(code, name) {
        localStorage.setItem("eiel_session_code", code);
        localStorage.setItem("eiel_session_name", name);
        
        ui.name.textContent = name;
        ui.code.textContent = code;
        
        ui.links.agua.href = `agua_${code}.html`;
        ui.links.obras.href = `obras_${code}.html`;
        ui.links.residuos.href = `residuos_${code}.html`;
        ui.links.cementerios.href = `cementerios_${code}.html`;

        ui.login.classList.add('hidden');
        ui.menu.classList.remove('hidden');
        ui.error.style.display = 'none';
    }

    function checkSession() {
        const code = localStorage.getItem("eiel_session_code");
        const name = localStorage.getItem("eiel_session_name");
        if(code && name) {
            loginSuccess(code, name);
        }
    }

    window.logout = function() {
        localStorage.removeItem("eiel_session_code");
        window.location.reload();
    }

    function showError(msg) {
        ui.error.textContent = msg;
        ui.error.style.display = 'block';
    }

    // Init
    checkSession();

</script>
</body>
</html>