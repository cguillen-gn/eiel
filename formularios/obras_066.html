<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>xzxzFormulario Obras - Elda</title>
<style>
:root {
  --primary: #FF9800;
  --primary-hover: #e68900;
  --secondary: #64748b;
  --success: #10b981;
  --danger: #ef4444;
  --warning: #f59e0b;
  --bg-page: #f8fafc;
  --bg-card: #ffffff;
  --border: #e2e8f0;
  --text-primary: #0f172a;
  --text-secondary: #64748b;
  --shadow: 0 1px 3px rgba(0, 0, 0, 0.1), 0 1px 2px rgba(0, 0, 0, 0.06);
  --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
  background: var(--bg-page);
  color: var(--text-primary);
  line-height: 1.6;
  padding: 20px;
  min-height: 100vh;
}

.header {
  background: linear-gradient(135deg, var(--primary) 0%, #3b82f6 100%);
  color: white;
  padding: 24px 32px;
  border-radius: 16px;
  margin-bottom: 24px;
  box-shadow: var(--shadow-lg);
}

.header h1 {
  font-size: 1.75rem;
  font-weight: 700;
  margin-bottom: 4px;
}

.header .subtitle {
  font-size: 1rem;
  opacity: 0.95;
  font-weight: 500;
}

.container {
  max-width: 900px;
  margin: 0 auto;
}

.card {
  background: var(--bg-card);
  border-radius: 12px;
  padding: 32px;
  margin-bottom: 24px;
  box-shadow: var(--shadow);
  border: 1px solid var(--border);
}

.section-title {
  font-size: 1.25rem;
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 20px;
  padding-bottom: 12px;
  border-bottom: 2px solid var(--border);
  display: flex;
  align-items: center;
  gap: 10px;
}

.section-title::before {
  content: '';
  width: 4px;
  height: 24px;
  background: var(--primary);
  border-radius: 2px;
}

.form-group {
  margin-bottom: 24px;
}

.form-label {
  display: block;
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 8px;
  font-size: 0.95rem;
}

.form-input {
  width: 100%;
  max-width: 300px;
  padding: 12px 16px;
  border: 2px solid var(--border);
  border-radius: 8px;
  font-size: 1rem;
  transition: all 0.2s;
  font-family: inherit;
}

.form-input:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
}

.form-input::placeholder {
  color: var(--text-secondary);
}

.table-container {
  overflow-x: auto;
  border-radius: 8px;
  border: 1px solid var(--border);
}

table {
  width: 100%;
  border-collapse: collapse;
  background: white;
}

thead {
  background: linear-gradient(to bottom, #f8fafc, #f1f5f9);
}

th {
  padding: 14px 16px;
  text-align: left;
  font-weight: 600;
  color: var(--text-primary);
  font-size: 0.9rem;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  border-bottom: 2px solid var(--border);
}

td {
  padding: 14px 16px;
  border-bottom: 1px solid var(--border);
}

tbody tr:hover {
  background: #f8fafc;
}

tbody tr:last-child td {
  border-bottom: none;
}

td input[type="number"] {
  max-width: 100px;
  padding: 8px 12px;
  border: 2px solid var(--border);
  border-radius: 6px;
  font-size: 0.95rem;
  transition: all 0.2s;
}

td input[type="number"]:focus {
  outline: none;
  border-color: var(--primary);
}

.file-upload-area {
  border: 2px dashed var(--border);
  border-radius: 8px;
  padding: 24px;
  text-align: center;
  background: #f8fafc;
  transition: all 0.2s;
  cursor: pointer;
  margin-bottom: 16px;
}

.file-upload-area:hover {
  border-color: var(--primary);
  background: #eff6ff;
}

.file-upload-area input[type="file"] {
  display: none;
}

.file-upload-label {
  cursor: pointer;
  color: var(--primary);
  font-weight: 600;
  font-size: 1rem;
}

.file-upload-hint {
  display: block;
  margin-top: 8px;
  color: var(--text-secondary);
  font-size: 0.9rem;
}

.file-list {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.file-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 16px;
  background: #f8fafc;
  border: 1px solid var(--border);
  border-radius: 8px;
  transition: all 0.2s;
}

.file-item:hover {
  background: #f1f5f9;
}

.file-name {
  display: flex;
  align-items: center;
  gap: 10px;
  font-size: 0.95rem;
  color: var(--text-primary);
}

.file-icon {
  font-size: 1.2rem;
}

.btn-remove {
  background: none;
  border: none;
  color: var(--danger);
  font-size: 1.2rem;
  cursor: pointer;
  padding: 4px 8px;
  border-radius: 4px;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
}

.btn-remove:hover {
  background: #fee2e2;
}

.btn-primary {
  background: var(--primary);
  color: white;
  border: none;
  padding: 14px 32px;
  font-size: 1rem;
  font-weight: 600;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.2s;
  box-shadow: var(--shadow);
  width: 100%;
  max-width: 300px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
}

.btn-primary:hover {
  background: var(--primary-hover);
  box-shadow: var(--shadow-lg);
  transform: translateY(-1px);
}

.btn-primary:active {
  transform: translateY(0);
}

.btn-primary:disabled {
  background: var(--secondary);
  cursor: not-allowed;
  opacity: 0.6;
}

.message {
  padding: 16px 20px;
  border-radius: 8px;
  margin-top: 20px;
  font-weight: 600;
  display: none;
  animation: slideIn 0.3s ease;
}

@keyframes slideIn {
  from {
    opacity: 0;
    transform: translateY(-10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.message.success {
  background: #d1fae5;
  color: #065f46;
  border: 1px solid #6ee7b7;
  display: block;
}

.message.error {
  background: #fee2e2;
  color: #991b1b;
  border: 1px solid #fca5a5;
  display: block;
}

.message.info {
  background: #dbeafe;
  color: #1e40af;
  border: 1px solid #93c5fd;
  display: block;
}

.back-link {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  color: var(--primary);
  text-decoration: none;
  font-weight: 600;
  padding: 10px 16px;
  border-radius: 8px;
  transition: all 0.2s;
  margin-bottom: 20px;
}

.back-link:hover {
  background: #eff6ff;
}

@media (max-width: 768px) {
  body {
    padding: 12px;
  }
  
  .header {
    padding: 20px;
  }
  
  .header h1 {
    font-size: 1.5rem;
  }
  
  .card {
    padding: 20px;
  }
  
  .form-input, .btn-primary {
    max-width: 100%;
  }
  
  table {
    font-size: 0.9rem;
  }
  
  th, td {
    padding: 10px;
  }
}
</style>
</head>

<body>
<div class="container">

<a href="../index.html" class="back-link">
  ← Volver al menú principal
</a>
<div class="header">
  <h1>🏗️ Formulario de Obras</h1>
  <div class="subtitle">Municipio: <span id="muniName">Elda</span> (066)</div>
</div>

<form id="frmObras">

<div class="card">
  <h2 class="section-title">Actualización de Estados</h2>

  <table>
    <thead>
      <tr>
        <th>Código Obra</th>
        <th>Obra</th>
        <th>Plan</th>
        <th>Estado obra</th>
        <th>Adjunta Proyecto</th>
      </tr>
    </thead>
    <tbody>
      
      
      <tr>
        <td>OB066058</td> 
        <td>CONTRATACIÓN CONJUNTA DE REDACCIÓN DEL PROYECTO CONSTRUCTIVO Y EJECUCIÓN MATERIAL DE LAS OBRAS DE ADECUACIÓN Y REFORMA DE LA PLAZA DE TOROS DE ELDA Y SU ENTORNO PARA SU REHABILITACIÓN Y ADECUACIÓN COMO ESPACIO DE USO PÚBLICO. PLAN RENACE.</td>
        <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

        <td>
          
            <select data-index="1" class="select-estado">
              <option value="">-- Seleccione --</option>
              <option>No iniciada</option>
              <option>En ejecución</option>
              <option>Paralizada</option>
              <option>Finalizada</option>
              <option>Anulada</option>
            </select>
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '1', 'OB066058')">
            Adjuntar
          </button>
          <div id="adjuntos_1" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066033</td> 
        <td>EL AYUNTAMIENTO DE ELDA REHABILITARÁ LAS PLAZAS DEL MATADERO Y DE SANTIAGO CON UNA INVERSIÓN DE 250.000 EUROS</td>
        <td>None</td>

        <td>
          
            <select data-index="2" class="select-estado">
              <option value="">-- Seleccione --</option>
              <option>No iniciada</option>
              <option>En ejecución</option>
              <option>Paralizada</option>
              <option>Finalizada</option>
              <option>Anulada</option>
            </select>
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '2', 'OB066033')">
            Adjuntar
          </button>
          <div id="adjuntos_2" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066045</td> 
        <td>BARRIO DE LA FERIA</td>
        <td>None</td>

        <td>
          
            <select data-index="3" class="select-estado">
              <option value="">-- Seleccione --</option>
              <option>No iniciada</option>
              <option>En ejecución</option>
              <option>Paralizada</option>
              <option>Finalizada</option>
              <option>Anulada</option>
            </select>
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '3', 'OB066045')">
            Adjuntar
          </button>
          <div id="adjuntos_3" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066123</td> 
        <td>OBRAS DE  REFORMA DEL  ESPACIO PÚBLICO DEL RECINTO DEL JARDÍN DE LA MÚSICA, SITUADO EN LA ZONA CENTRAL DEL MUNICIPIO, DENTRO DE LA MANZANA DELIMITADA POR LAS CALLES HILARIÓN ESLAVA, RAMÓN GORGE, ANTONINO VERA Y PADRE MANJÓN, PLAN ELDA RENACE.</td>
        <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

        <td>
          
            <select data-index="4" class="select-estado">
              <option value="">-- Seleccione --</option>
              <option>No iniciada</option>
              <option>En ejecución</option>
              <option>Paralizada</option>
              <option>Finalizada</option>
              <option>Anulada</option>
            </select>
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '4', 'OB066123')">
            Adjuntar
          </button>
          <div id="adjuntos_4" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066104</td> 
        <td>EI NUEVO ALMAFRÁ (03011215). AULA PSICOMOTRICIDAD,ACCESIBILIDAD,VENTANAS Y LUMINARIAS,ALICATADO,FONTANERÍA,PATIO Y JUEGOS,PINTURA.</td>
        <td>GVA (PROGRAMA EDIFICANT)</td>

        <td>
          
            <select data-index="5" class="select-estado">
              <option value="">-- Seleccione --</option>
              <option>No iniciada</option>
              <option>En ejecución</option>
              <option>Paralizada</option>
              <option>Finalizada</option>
              <option>Anulada</option>
            </select>
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '5', 'OB066104')">
            Adjuntar
          </button>
          <div id="adjuntos_5" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066108</td> 
        <td>CENTRO PÚBLICO FPA ANTONIO PORPETTA (03011771). REPARACIÓN CUBIERTA, ASCENSOR Y BAÑO ADAPTADO.</td>
        <td>GVA (PROGRAMA EDIFICANT)</td>

        <td>
          
            <select data-index="6" class="select-estado">
              <option value="">-- Seleccione --</option>
              <option>No iniciada</option>
              <option>En ejecución</option>
              <option>Paralizada</option>
              <option>Finalizada</option>
              <option>Anulada</option>
            </select>
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '6', 'OB066108')">
            Adjuntar
          </button>
          <div id="adjuntos_6" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066115</td> 
        <td>IES LA TORRETA (03005768). VALLADO PERIMETRAL, NUEVAS AULAS PARA TALLERES, PLACAS FOTOVOLTAICAS.</td>
        <td>GVA (PROGRAMA EDIFICANT)</td>

        <td>
          
            <select data-index="7" class="select-estado">
              <option value="">-- Seleccione --</option>
              <option>No iniciada</option>
              <option>En ejecución</option>
              <option>Paralizada</option>
              <option>Finalizada</option>
              <option>Anulada</option>
            </select>
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '7', 'OB066115')">
            Adjuntar
          </button>
          <div id="adjuntos_7" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066107</td> 
        <td>CEIP SANTO NEGRO (03010247). ASCENSOR,NUEVO SALÓN ACTOS,VENTANAS Y LUMINARIAS,MEJORA PATIO,ALICATADO,FONTANERÍA,ALBAÑILERIA.</td>
        <td>GVA (PROGRAMA EDIFICANT)</td>

        <td>
          
            <select data-index="8" class="select-estado">
              <option value="">-- Seleccione --</option>
              <option>No iniciada</option>
              <option>En ejecución</option>
              <option>Paralizada</option>
              <option>Finalizada</option>
              <option>Anulada</option>
            </select>
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '8', 'OB066107')">
            Adjuntar
          </button>
          <div id="adjuntos_8" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066114</td> 
        <td>IES LA MELVA (03005720). ASCENSOR Y ESCALERA DE EMERGENCIA, CAMBIO INSTALACIÓN ELÉCTRICA, CONSTRUCCIÓN GIMNASIO.</td>
        <td>GVA (PROGRAMA EDIFICANT)</td>

        <td>
          
            <select data-index="9" class="select-estado">
              <option value="">-- Seleccione --</option>
              <option>No iniciada</option>
              <option>En ejecución</option>
              <option>Paralizada</option>
              <option>Finalizada</option>
              <option>Anulada</option>
            </select>
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '9', 'OB066114')">
            Adjuntar
          </button>
          <div id="adjuntos_9" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066102</td> 
        <td>CEIP VIRGEN DE LA SALUD (03012074). GIMNASIO,ASCENSOR,INSTALACIÓN ELEC,VALLADO,VENTANAS Y LUMINARIAS,PATIO,RADIADORES,ALICATADO,FONTANER.</td>
        <td>GVA (PROGRAMA EDIFICANT)</td>

        <td>
          
            <select data-index="10" class="select-estado">
              <option value="">-- Seleccione --</option>
              <option>No iniciada</option>
              <option>En ejecución</option>
              <option>Paralizada</option>
              <option>Finalizada</option>
              <option>Anulada</option>
            </select>
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '10', 'OB066102')">
            Adjuntar
          </button>
          <div id="adjuntos_10" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066038</td> 
        <td>EL AYUNTAMIENTO DE ELDA REFORMA EL MURO DE LA CALLE RAMÓN NOCEDAL PARA AUMENTAR LA SEGURIDAD DE LOS USUARIOS DE LA ASOCIACIÓN DE ALZHEIMER</td>
        <td>None</td>

        <td>
          
            <select data-index="11" class="select-estado">
              <option value="">-- Seleccione --</option>
              <option>No iniciada</option>
              <option>En ejecución</option>
              <option>Paralizada</option>
              <option>Finalizada</option>
              <option>Anulada</option>
            </select>
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '11', 'OB066038')">
            Adjuntar
          </button>
          <div id="adjuntos_11" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066088</td> 
        <td>RENOVACIÓN DE LA RED DE AGUA POTABLE QUE SE LLEVARAN A CABO EN EL ENTORNO DEL PARQUE DE LA CONCORDIA, ASÍ COMO LA RESTITUCIÓN DE LOS DIFERENTES ELEMENTOS DE LA VÍA PÚBLICA E INSTALACIONES AFECTADAS POR LA RENOVACIÓN DE LA RED</td>
        <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

        <td>
          
            <select data-index="12" class="select-estado">
              <option value="">-- Seleccione --</option>
              <option>No iniciada</option>
              <option>En ejecución</option>
              <option>Paralizada</option>
              <option>Finalizada</option>
              <option>Anulada</option>
            </select>
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '12', 'OB066088')">
            Adjuntar
          </button>
          <div id="adjuntos_12" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066139</td> 
        <td>RENOVACIÓN URBANA CALLE DAHELLOS DE ELDA. NEXT GENERATION EU.</td>
        <td>PLAN TERRITORIAL DE SOSTENIBILIDAD TURÍSTICA EN DESTINO COMUNITAT VALENCIANA 2023 (PTSTD CV 23)</td>

        <td>
          
            <select data-index="13" class="select-estado">
              <option value="">-- Seleccione --</option>
              <option>No iniciada</option>
              <option>En ejecución</option>
              <option>Paralizada</option>
              <option>Finalizada</option>
              <option>Anulada</option>
            </select>
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '13', 'OB066139')">
            Adjuntar
          </button>
          <div id="adjuntos_13" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066144</td> 
        <td>REFORMA DE GRADERÍOS Y VESTUARIOS EN PABELLÓN JUAN CARLOS VERDÚ DE ELDA.</td>
        <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

        <td>
          
            <select data-index="14" class="select-estado">
              <option value="">-- Seleccione --</option>
              <option>No iniciada</option>
              <option>En ejecución</option>
              <option>Paralizada</option>
              <option>Finalizada</option>
              <option>Anulada</option>
            </select>
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '14', 'OB066144')">
            Adjuntar
          </button>
          <div id="adjuntos_14" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066145</td> 
        <td>REFORMA ASEOS MERCADO CENTRAL DE ELDA, SEGÚN EL PROYECTO REDACTADO AL EFECTO POR EL ARQUITECTO TÉCNICO D. RUBÉN NAVARRO MONZÓ Y APROBADO POR LA ADMINISTRACIÓN</td>
        <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

        <td>
          
            <select data-index="15" class="select-estado">
              <option value="">-- Seleccione --</option>
              <option>No iniciada</option>
              <option>En ejecución</option>
              <option>Paralizada</option>
              <option>Finalizada</option>
              <option>Anulada</option>
            </select>
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '15', 'OB066145')">
            Adjuntar
          </button>
          <div id="adjuntos_15" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066142</td> 
        <td>MEJORA, MODERNIZACIÓN Y DOTACIÓN DE INFRAESTRUCTURAS Y SERVICIOS EN EL POLÍGONO INDUSTRIAL FINCA LACY 2024</td>
        <td>IVACE: PARQUES EMPRESARIALES 2024</td>

        <td>
          
            <select data-index="16" class="select-estado">
              <option value="">-- Seleccione --</option>
              <option>No iniciada</option>
              <option>En ejecución</option>
              <option>Paralizada</option>
              <option>Finalizada</option>
              <option>Anulada</option>
            </select>
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '16', 'OB066142')">
            Adjuntar
          </button>
          <div id="adjuntos_16" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066131</td> 
        <td>EJECUCIÓN DEL “PROYECTO BÁSICO Y DE EJECUCIÓN DE REFORMA, ADECUACIÓN Y AMPLIACIÓN EN EL CEE MIGUEL DE CERVANTES II” ADHERIDOS AL PROGRAMA “EDIFICANT” DE LA GENERALITAT VALENCIANA (DECRETO-LEY 5/2017, DE 20 DE OCTUBRE, DEL CONSELL).</td>
        <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

        <td>
          
            <select data-index="17" class="select-estado">
              <option value="">-- Seleccione --</option>
              <option>No iniciada</option>
              <option>En ejecución</option>
              <option>Paralizada</option>
              <option>Finalizada</option>
              <option>Anulada</option>
            </select>
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '17', 'OB066131')">
            Adjuntar
          </button>
          <div id="adjuntos_17" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066137</td> 
        <td>TRABAJOS DE EJECUCIÓN DE LAS OBRAS DE ADAPTACIÓN DEL ECOPARQUE DE ELDA EN EL MARCO DEL PROYECTO DE GESTIÓN DE LA RED DE ECOPARQUES CONSORCIADA DEL CONSORCIO CREA, ÁREA DE GESTIÓN A3.</td>
        <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

        <td>
          
            <select data-index="18" class="select-estado">
              <option value="">-- Seleccione --</option>
              <option>No iniciada</option>
              <option>En ejecución</option>
              <option>Paralizada</option>
              <option>Finalizada</option>
              <option>Anulada</option>
            </select>
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '18', 'OB066137')">
            Adjuntar
          </button>
          <div id="adjuntos_18" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066112</td> 
        <td>EI 1ER CICLO SANTA INFANCIA (03009774). REPOSICIÓN.</td>
        <td>GVA (PROGRAMA EDIFICANT)</td>

        <td>
          
            <select data-index="19" class="select-estado">
              <option value="">-- Seleccione --</option>
              <option>No iniciada</option>
              <option>En ejecución</option>
              <option>Paralizada</option>
              <option>Finalizada</option>
              <option>Anulada</option>
            </select>
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '19', 'OB066112')">
            Adjuntar
          </button>
          <div id="adjuntos_19" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066141</td> 
        <td>MEMORA, MODERNIZACION Y REFORMA POLIGONO CAMPO ALTO 2024</td>
        <td>IVACE: PARQUES EMPRESARIALES 2024</td>

        <td>
          
            <select data-index="20" class="select-estado">
              <option value="">-- Seleccione --</option>
              <option>No iniciada</option>
              <option>En ejecución</option>
              <option>Paralizada</option>
              <option>Finalizada</option>
              <option>Anulada</option>
            </select>
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '20', 'OB066141')">
            Adjuntar
          </button>
          <div id="adjuntos_20" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066140</td> 
        <td>OBRAS DE AMPLIACIÓN DEL CEMENTERIO VIRGEN DE LOS DOLORES DE ELDA, FASES 1 Y 2.</td>
        <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

        <td>
          
            <select data-index="21" class="select-estado">
              <option value="">-- Seleccione --</option>
              <option>No iniciada</option>
              <option>En ejecución</option>
              <option>Paralizada</option>
              <option>Finalizada</option>
              <option>Anulada</option>
            </select>
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '21', 'OB066140')">
            Adjuntar
          </button>
          <div id="adjuntos_21" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066143</td> 
        <td>IES LA MELVA DE ELDA. ADECUACIÓN DE ESPACIOS E INFRAESTRUCTURAS PARA LA IMPLANTACIÓN DEL CICLO FORMATIVO DE GRADO SUPERIOR DE PRÓTESIS DENTALES DE LA FAMILIA PROFESIONAL DE SANITARIA.</td>
        <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

        <td>
          
            <select data-index="22" class="select-estado">
              <option value="">-- Seleccione --</option>
              <option>No iniciada</option>
              <option>En ejecución</option>
              <option>Paralizada</option>
              <option>Finalizada</option>
              <option>Anulada</option>
            </select>
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '22', 'OB066143')">
            Adjuntar
          </button>
          <div id="adjuntos_22" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066039</td> 
        <td>EL AYUNTAMIENTO DE ELDA MEJORARÁ LA ACCESIBILIDAD DEL BARRIO VIRGEN DE LA SALUD CON LA CONSTRUCCIÓN DE LAS ACERAS DE LA CALLE ASTRONOMÍA Y EL PASEO DE LAS DELICIAS</td>
        <td>None</td>

        <td>
          
            <select data-index="23" class="select-estado">
              <option value="">-- Seleccione --</option>
              <option>No iniciada</option>
              <option>En ejecución</option>
              <option>Paralizada</option>
              <option>Finalizada</option>
              <option>Anulada</option>
            </select>
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '23', 'OB066039')">
            Adjuntar
          </button>
          <div id="adjuntos_23" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066059</td> 
        <td>PASARELA PEATONAL DE ACCESO A LA ERMITA DE SAN ANTÓN (PLAN ELDA RENACE).</td>
        <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

        <td>
          
            <select data-index="24" class="select-estado">
              <option value="">-- Seleccione --</option>
              <option>No iniciada</option>
              <option>En ejecución</option>
              <option>Paralizada</option>
              <option>Finalizada</option>
              <option>Anulada</option>
            </select>
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '24', 'OB066059')">
            Adjuntar
          </button>
          <div id="adjuntos_24" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066118</td> 
        <td>PROYECTO PARA LA MEJORA, MODERNIZACIÓN Y REURBANIZACIÓN DE LAS INFRAESTRUCTURAS DEL POLIGONO INDUSTRIAL CAMPO ALTO, ELDA. PARA ACOMETER EN 2022. 2022</td>
        <td>IVACE: PARQUES EMPRESARIALES 2022</td>

        <td>
          
            <select data-index="25" class="select-estado">
              <option value="">-- Seleccione --</option>
              <option>No iniciada</option>
              <option>En ejecución</option>
              <option>Paralizada</option>
              <option>Finalizada</option>
              <option>Anulada</option>
            </select>
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '25', 'OB066118')">
            Adjuntar
          </button>
          <div id="adjuntos_25" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066105</td> 
        <td>CEE PÚB. MIGUEL DE CERVANTES (03010806). ASEOS, ACCESIBILIDAD, EFICIENCIA ENERGÉTICA,INSTALACIÓN ELÉCTRICA Y GRUA ALUMNOS NECESIDADES EDUCATIVAS ESPECIALES.</td>
        <td>GVA (PROGRAMA EDIFICANT)</td>

        <td>
          
            <select data-index="26" class="select-estado">
              <option value="">-- Seleccione --</option>
              <option>No iniciada</option>
              <option>En ejecución</option>
              <option>Paralizada</option>
              <option>Finalizada</option>
              <option>Anulada</option>
            </select>
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '26', 'OB066105')">
            Adjuntar
          </button>
          <div id="adjuntos_26" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066147</td> 
        <td>REURBANIZACIÓN PEATONAL DEL ENTORNO DEL AYUNTAMIENTO Y LA IGLESIA SANTA ANA EN EL CENTRO HISTÓRICO</td>
        <td>PLAN TERRITORIAL DE SOSTENIBILIDAD TURÍSTICA EN DESTINO COMUNITAT VALENCIANA 2023 (PTSTD CV 23)</td>

        <td>
          
            <select data-index="27" class="select-estado">
              <option value="">-- Seleccione --</option>
              <option>No iniciada</option>
              <option>En ejecución</option>
              <option>Paralizada</option>
              <option>Finalizada</option>
              <option>Anulada</option>
            </select>
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '27', 'OB066147')">
            Adjuntar
          </button>
          <div id="adjuntos_27" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066148</td> 
        <td>ACONDICIONAMIENTO DE SENDEROS EN CAMINOS HISTÓRICOS: VÍA AUGUSTA</td>
        <td>PLAN TERRITORIAL DE SOSTENIBILIDAD TURÍSTICA EN DESTINO COMUNITAT VALENCIANA 2023 (PTSTD CV 23)</td>

        <td>
          
            <select data-index="28" class="select-estado">
              <option value="">-- Seleccione --</option>
              <option>No iniciada</option>
              <option>En ejecución</option>
              <option>Paralizada</option>
              <option>Finalizada</option>
              <option>Anulada</option>
            </select>
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '28', 'OB066148')">
            Adjuntar
          </button>
          <div id="adjuntos_28" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066149</td> 
        <td>PROYECTO INTERPRETATIVO DEL REFUGIO ANTIAÉREO A TRAVÉS DE LAS NUEVAS TECNOLOGÍAS</td>
        <td>PLAN TERRITORIAL DE SOSTENIBILIDAD TURÍSTICA EN DESTINO COMUNITAT VALENCIANA 2023 (PTSTD CV 23)</td>

        <td>
          
            <select data-index="29" class="select-estado">
              <option value="">-- Seleccione --</option>
              <option>No iniciada</option>
              <option>En ejecución</option>
              <option>Paralizada</option>
              <option>Finalizada</option>
              <option>Anulada</option>
            </select>
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '29', 'OB066149')">
            Adjuntar
          </button>
          <div id="adjuntos_29" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066132</td> 
        <td>PROYECTO DE ADECUACIÓN DE LA EDAR DEL VALLE DEL VINALOPÓ Y DE LAS INFRAESTRUCTURAS PARA LA REUTILIZACIÓN DE SU EFLUENTE. PRTR. NEXT GENERATION EU.</td>
        <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

        <td>
          
            <select data-index="30" class="select-estado">
              <option value="">-- Seleccione --</option>
              <option>No iniciada</option>
              <option>En ejecución</option>
              <option>Paralizada</option>
              <option>Finalizada</option>
              <option>Anulada</option>
            </select>
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '30', 'OB066132')">
            Adjuntar
          </button>
          <div id="adjuntos_30" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066146</td> 
        <td>OBRAS DE ADECUACIÓN Y REFORMA DE LA PLAZA DE TOROS DE ELDA Y SU ENTORNO PARA SU REHABILITACIÓN Y ADECUACIÓN COMO ESPACIO DE USO PÚBLICO</td>
        <td>PLAN PLANIFICA 2024-27 BOP: 07/01/2025</td>

        <td>
          
            <select data-index="31" class="select-estado">
              <option value="">-- Seleccione --</option>
              <option>No iniciada</option>
              <option>En ejecución</option>
              <option>Paralizada</option>
              <option>Finalizada</option>
              <option>Anulada</option>
            </select>
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '31', 'OB066146')">
            Adjuntar
          </button>
          <div id="adjuntos_31" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066150</td> 
        <td>REHABILITACIÓN DE AMBAS ESCALERAS, NUEVO MURO Y JARDÍN EN CALLE CLÉRIGOS EN SU CONFLUENCIA CON AVDA. NOVO HAMBURGO DE ELDA, INCLUIDA DENTRO DEL PLAN "ELDA PARTE DE TI"</td>
        <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

        <td>
          
            <select data-index="32" class="select-estado">
              <option value="">-- Seleccione --</option>
              <option>No iniciada</option>
              <option>En ejecución</option>
              <option>Paralizada</option>
              <option>Finalizada</option>
              <option>Anulada</option>
            </select>
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '32', 'OB066150')">
            Adjuntar
          </button>
          <div id="adjuntos_32" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066151</td> 
        <td>RENOVACIÓN, ADECUACIÓN Y MANTENIMIENTO LOS ELEMENTOS DEL PARQUE DE NUEVA FRATERNIDAD DE ELDA Y LAS ZONAS DE JUEGO EXISTENTES, INCLUIDAS DENTRO DEL PLAN "ELDA PARTE DE TI".</td>
        <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

        <td>
          
            <select data-index="33" class="select-estado">
              <option value="">-- Seleccione --</option>
              <option>No iniciada</option>
              <option>En ejecución</option>
              <option>Paralizada</option>
              <option>Finalizada</option>
              <option>Anulada</option>
            </select>
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '33', 'OB066151')">
            Adjuntar
          </button>
          <div id="adjuntos_33" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066152</td> 
        <td>CONSTRUCCIÓN DEL NUEVO PARQUE DE BOMBEROS EN ELDA</td>
        <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

        <td>
          
            <select data-index="34" class="select-estado">
              <option value="">-- Seleccione --</option>
              <option>No iniciada</option>
              <option>En ejecución</option>
              <option>Paralizada</option>
              <option>Finalizada</option>
              <option>Anulada</option>
            </select>
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '34', 'OB066152')">
            Adjuntar
          </button>
          <div id="adjuntos_34" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066153</td> 
        <td>DERRIBO Y CONSTRUCCIÓN DE NUEVO EDIFICIO PARA LA POLICÍA LOCAL DE ELDA.</td>
        <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

        <td>
          
            <select data-index="35" class="select-estado">
              <option value="">-- Seleccione --</option>
              <option>No iniciada</option>
              <option>En ejecución</option>
              <option>Paralizada</option>
              <option>Finalizada</option>
              <option>Anulada</option>
            </select>
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '35', 'OB066153')">
            Adjuntar
          </button>
          <div id="adjuntos_35" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066154</td> 
        <td>REURBANIZACIÓN DE LAS CALLES UBICADAS EN EL ENTORNO DE LA IGLESIA DE SANTA ANA FINANCIADO POR LA UNIÓN EUROPEA CON LOS FONDOS NEXT GENERATION EU.</td>
        <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

        <td>
          
            <select data-index="36" class="select-estado">
              <option value="">-- Seleccione --</option>
              <option>No iniciada</option>
              <option>En ejecución</option>
              <option>Paralizada</option>
              <option>Finalizada</option>
              <option>Anulada</option>
            </select>
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '36', 'OB066154')">
            Adjuntar
          </button>
          <div id="adjuntos_36" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066155</td> 
        <td>MEJORA MODERNIZACION Y DOTACION DEINFRAESTRUCTURAS Y SERVICIOS EN PI CAMPOALTO</td>
        <td>IVACE: PARQUES EMPRESARIALES 2025-2026</td>

        <td>
          
            <select data-index="37" class="select-estado">
              <option value="">-- Seleccione --</option>
              <option>No iniciada</option>
              <option>En ejecución</option>
              <option>Paralizada</option>
              <option>Finalizada</option>
              <option>Anulada</option>
            </select>
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '37', 'OB066155')">
            Adjuntar
          </button>
          <div id="adjuntos_37" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066156</td> 
        <td>MEJORA MODERNIZACION Y DOTACION DEINFRAESTRUCTURAS Y SERVICIOS EN PI FINCALACY</td>
        <td>IVACE: PARQUES EMPRESARIALES 2025-2026</td>

        <td>
          
            <select data-index="38" class="select-estado">
              <option value="">-- Seleccione --</option>
              <option>No iniciada</option>
              <option>En ejecución</option>
              <option>Paralizada</option>
              <option>Finalizada</option>
              <option>Anulada</option>
            </select>
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '38', 'OB066156')">
            Adjuntar
          </button>
          <div id="adjuntos_38" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066157</td> 
        <td>OBRAS PARA LA AMPLIACIÓN DEL SERVICIO DE URGENCIAS DEL HOSPITAL GENERAL UNIVERSITARIO DE ELDA, RESPETUOSAS CON EL MEDIO AMBIENTE.</td>
        <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

        <td>
          
            <select data-index="39" class="select-estado">
              <option value="">-- Seleccione --</option>
              <option>No iniciada</option>
              <option>En ejecución</option>
              <option>Paralizada</option>
              <option>Finalizada</option>
              <option>Anulada</option>
            </select>
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '39', 'OB066157')">
            Adjuntar
          </button>
          <div id="adjuntos_39" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066158</td> 
        <td>REHABILITACIÓN DEL ANTIGUO CONSERVATORIO DE MÚSICA DE ELDA</td>
        <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

        <td>
          
            <select data-index="40" class="select-estado">
              <option value="">-- Seleccione --</option>
              <option>No iniciada</option>
              <option>En ejecución</option>
              <option>Paralizada</option>
              <option>Finalizada</option>
              <option>Anulada</option>
            </select>
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '40', 'OB066158')">
            Adjuntar
          </button>
          <div id="adjuntos_40" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066159</td> 
        <td>OBRAS DE REHABILITACIÓN DE LA PLAZA UBICADA ENTRE CALLE NUEVA Y CALLE SAN JOSÉ DE CALASANZ, INCLUIDA DENTRO DEL PLAN "ELDA PARTE DE TI".</td>
        <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

        <td>
          
            <select data-index="41" class="select-estado">
              <option value="">-- Seleccione --</option>
              <option>No iniciada</option>
              <option>En ejecución</option>
              <option>Paralizada</option>
              <option>Finalizada</option>
              <option>Anulada</option>
            </select>
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '41', 'OB066159')">
            Adjuntar
          </button>
          <div id="adjuntos_41" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066018</td> 
        <td>EL AYUNTAMIENTO DE ELDA REPARA Y ASFALTA EL CAMINO QUE UNE EL POLÍGONO CAMPO ALTO CON LA ESTACIÓN DE MONÓVAR PARA MEJORAR EL PASO DE LOS VEHÍCULOS</td>
        <td>None</td>

        <td>
          
            Finalizada
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '42', 'OB066018')">
            Adjuntar
          </button>
          <div id="adjuntos_42" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066022</td> 
        <td>EL AYUNTAMIENTO DE ELDA REPARA EL PAVIMENTO Y EL SANEAMIENTO DE LA CALLE VIRGEN DEL MILAGRO</td>
        <td>None</td>

        <td>
          
            Finalizada
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '43', 'OB066022')">
            Adjuntar
          </button>
          <div id="adjuntos_43" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066129</td> 
        <td>MEJORA MODERNIZACION Y DOTACION DE INFRAESTRUCTURAS CAMPO ALTO 20232023</td>
        <td>IVACE: PARQUES EMPRESARIALES 2023</td>

        <td>
          
            Finalizada
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '44', 'OB066129')">
            Adjuntar
          </button>
          <div id="adjuntos_44" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066053</td> 
        <td>ALMACÉN Y TORRE</td>
        <td>PLAN +DEPORTE 2021 BOP: 17/08/2021</td>

        <td>
          
            Finalizada
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '45', 'OB066053')">
            Adjuntar
          </button>
          <div id="adjuntos_45" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066133</td> 
        <td>RENOVACIÓN DE LAS INSTALACIONES DE ALUMBRADO PÚBLICO EN ELDA. FEDER DE CRECIMIENTO SOSTENIBLE 2014-2020.</td>
        <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

        <td>
          
            Finalizada
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '46', 'OB066133')">
            Adjuntar
          </button>
          <div id="adjuntos_46" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066128</td> 
        <td>CEIP JUAN RICO Y AMAT. ASCENSOR,RADIADORES,INSTALACIÓN ELÉCTRICA,VENTANAS Y LUMINARIAS,ACCESIBILIDAD,ALICATADO,PATIO,VALLAD</td>
        <td>GVA (PROGRAMA EDIFICANT)</td>

        <td>
          
            Finalizada
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '47', 'OB066128')">
            Adjuntar
          </button>
          <div id="adjuntos_47" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066134</td> 
        <td>APEO DE VIGUETAS DE FORMADO EN CUBIERTA EN EL EDIFICIO DE LA POLICÍA LOCAL DE ELDA</td>
        <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

        <td>
          
            Finalizada
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '48', 'OB066134')">
            Adjuntar
          </button>
          <div id="adjuntos_48" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066136</td> 
        <td>REURBANIZACIÓN DE LA CALLE RAMÓN GORGÉ ENTRE LAS CALLES HILARIÓN ESLAVA Y PADRE MANJÓN, Y LA ACERA DE LOS NÚMEROS IMPARES DE LA CALLE PADRE MANJÓN ENTRE LA CALLE RAMÓN GORGÉ Y LA CALLE ZORRILLA DE ELDA (PLAN RENACE).</td>
        <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

        <td>
          
            Finalizada
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '49', 'OB066136')">
            Adjuntar
          </button>
          <div id="adjuntos_49" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066015</td> 
        <td>EL AYUNTAMIENTO DE ELDA INICIA LOS TRABAJOS DE REMODELACIÓN DEL CAMPO DE FÚTBOL NÚMERO 3 DE LAS INSTALACIONES DE LA SISMAT</td>
        <td>None</td>

        <td>
          
            Finalizada
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '50', 'OB066015')">
            Adjuntar
          </button>
          <div id="adjuntos_50" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066116</td> 
        <td>PLAN INDUSTRIA 4.0 - MEJORA DE LA EFICIENCIA ENERGÉTICA Y DE LA IMAGEN PÚBLICA DEL POLÍGONO INDUSTRIAL TORRETA RÍO 2021</td>
        <td>IVACE: PARQUES EMPRESARIALES 2021</td>

        <td>
          
            Finalizada
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '51', 'OB066116')">
            Adjuntar
          </button>
          <div id="adjuntos_51" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066119</td> 
        <td>PLAN INDUSTRIA 4.0 - MEJORA INFRAESTRUCTURA POLÍGONO INDUSTRIAL CAMPO ALTO 2021</td>
        <td>IVACE: PARQUES EMPRESARIALES 2021</td>

        <td>
          
            Finalizada
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '52', 'OB066119')">
            Adjuntar
          </button>
          <div id="adjuntos_52" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
      
      <tr>
        <td>OB066117</td> 
        <td>PLAN INDUSTRIA 4.0 - MEJORA DE LA EFICIENCIA ENERGÉTICA Y DE LA IMAGEN PÚBLICA DEL POLÍGONO INDUSTRIAL FINCA LACY 2021</td>
        <td>IVACE: PARQUES EMPRESARIALES 2021</td>

        <td>
          
            Finalizada
          
        </td>

        <td>
          
          <button type="button" class="btn-adjuntar" onclick="subirAdjunto('066', '53', 'OB066117')">
            Adjuntar
          </button>
          <div id="adjuntos_53" style="font-size:13px; margin-top:4px;"></div>
          
        </td>
      </tr>
      
    </tbody>
  </table>
</div>

<div class="card" style="margin-top: 20px;">
  <button id="firmarBtn" class="btn-primary" type="button">
    <span>✓</span>
    Firmar y enviar formulario
  </button>
  <div id="mensaje" class="message"></div>
</div>

</form>

</div>

</div>

<script>
// ==========================================
// CONFIGURACIÓN Y VARIABLES GLOBALES
// ==========================================
// ASEGÚRATE DE QUE ESTAS URLS Y CÓDIGOS SON LOS CORRECTOS PARA OBRAS
const URL_ADJUNTOS = "https://script.google.com/macros/s/AKfycbySvcn7wgRbbNhnoKYPND7Ij7CaPgLzFKbNq-AfX80CkyV1J7aIKUQ8tQGYmmKBNQjb8A/exec"; 
const URL_GOOGLE_FORMS = "https://docs.google.com/forms/d/e/1FAIpQLSc84PLY4O2wM9ek3v6L14DzZ8jcqDtFeKOK01i38s7ttPt0Ng/formResponse";
const URL_GENERAR_PDF = "https://script.google.com/macros/s/AKfycbyxhsTZynldpFj9kyUIYmtflvHKvKr_ew4mRaB8LlnqEh5gxAC5f1ORRjIY2unS5ioO/exec";
const MUNI_CODE = '125'; // Ejemplo: Código del municipio de Obras
const MUNI_NAME = 'Senija'; // Ejemplo: Nombre del municipio de Obras


// Almacén de archivos (Clave = codigoObra, Valor = Array de archivos)
let adjuntosObras = {};

// ==========================================
// 1. UTILIDADES Y MENSAJES
// ==========================================

const mensaje = document.getElementById("mensaje");
const btnFirmar = document.getElementById("firmarBtn"); // Asumiendo que existe un botón de envío principal

function mostrarMensaje(texto, tipo) {
    mensaje.textContent = texto;
    mensaje.className = `message ${tipo}`;
    mensaje.style.display = 'block';
}

// ==========================================
// 2. FUNCIÓN DE SUBIDA BASE64 (MÉTODO IFRAME ADAPTADO)
//    Esta es la función que SÍ funciona.
// ==========================================

function subirArchivoIndividual(file, tipo, codigoObra) {
    console.log("🚀 Iniciando subida de:", file.name);
    
    return new Promise((resolve) => {
        const reader = new FileReader();
        
        reader.onerror = () => {
            console.error("❌ Error leyendo archivo:", reader.error);
            resolve(false);
        };
        
        reader.onload = function() {
            const base64 = reader.result.split(',')[1];
            
            const iframeName = "upload_" + Date.now();
            const iframe = document.createElement("iframe");
            iframe.name = iframeName;
            iframe.style.display = "none";
            document.body.appendChild(iframe);

            const form = document.createElement("form");
            form.method = "POST";
            form.action = URL_ADJUNTOS;
            form.target = iframeName;

            const addHidden = (name, value) => {
                const inp = document.createElement("input");
                inp.type = "hidden";
                inp.name = name;
                inp.value = value;
                form.appendChild(inp);
            };

            // PARÁMETROS CRÍTICOS
            addHidden("tipo", tipo); // 'obra'
            addHidden("mun", MUNI_CODE);
            addHidden("file0", base64);
            addHidden("filename", file.name);
            addHidden("mimeType", file.type);
            
            // CONTEXTO ESPECÍFICO DE OBRAS
            if (tipo === "obra" && codigoObra) {
                addHidden("obra", codigoObra); // Apps Script leerá e.parameter.obra
            }

            document.body.appendChild(form);

            let procesado = false;

            iframe.onload = () => {
                if (procesado) return;
                procesado = true;
                
                setTimeout(() => {
                    let success = false;
                    try {
                        const doc = iframe.contentDocument || iframe.contentWindow.document;
                        const textarea = doc.getElementsByTagName("textarea")[0];
                        
                        if (textarea) {
                            const data = JSON.parse(textarea.value);
                            if (data.status === "ok" || data.status === "success") {
                                success = true;
                            }
                        }
                    } catch(err) {
                        console.error("❌ Error procesando respuesta de iframe:", err.message);
                    }

                    try { form.remove(); } catch(e) {}
                    try { iframe.remove(); } catch(e) {}
                    
                    resolve(success);
                }, 3000); 
            };

            iframe.onerror = () => {
                console.error("❌ Error en iframe, subida fallida.");
                if (!procesado) {
                    procesado = true;
                    try { form.remove(); } catch(e) {}
                    try { iframe.remove(); } catch(e) {}
                    resolve(false);
                }
            };

            form.submit();
        };

        reader.readAsDataURL(file);
    });
}


// ==========================================
// 3. FUNCIÓN DE SUBIDA ESPECÍFICA DE OBRAS (POR BOTÓN DE OBRA)
//    Orquesta la subida de adjuntos y actualiza la UI.
// ==========================================

async function subirAdjunto(munCode, obraId, codigoObra) {
    console.log(`🖱️ Click en adjuntar: Obra ${obraId}, Mun ${munCode}`);

    // TRUCO: Crear el input y añadirlo al body
    const fileInput = document.createElement("input");
    fileInput.type = "file";
    fileInput.multiple = true;
    fileInput.style.display = "none";
    document.body.appendChild(fileInput);

    fileInput.onchange = async () => {
        const files = Array.from(fileInput.files);
        if (!files.length) {
            document.body.removeChild(fileInput);
            return;
        }

        // 1. Añadir visualmente
        if (!adjuntosObras[obraId]) adjuntosObras[obraId] = [];
        adjuntosObras[obraId].push(...files);
        renderAdjuntosObra(obraId);

        // 2. Preparar zona de mensajes
        const statusDiv = document.getElementById("adjuntos_" + obraId);
        let msgBox = document.createElement("div");
        msgBox.className = "message info";
        msgBox.style.fontSize = "12px";
        msgBox.style.marginTop = "5px";
        msgBox.style.display = 'block';
        statusDiv.appendChild(msgBox);

        // 3. Subir uno a uno (¡LA LLAMADA CORREGIDA!)
        for (let i = 0; i < files.length; i++) {
            const file = files[i];
            msgBox.textContent = `⏳ Subiendo ${i+1}/${files.length}: ${file.name}...`;

            // LLAMADA FINAL Y CORREGIDA: Usa el método iframe/base64 y pasa el contexto
            const success = await subirArchivoIndividual(file, "obra", codigoObra); 

            if (success) {
                console.log(`✅ ${file.name} subido.`);
            } else {
                console.error(`❌ Error subiendo ${file.name}`);
                msgBox.textContent = `⚠️ Error subiendo ${file.name}. Intente de nuevo.`;
                msgBox.className = "message error";
                await new Promise(r => setTimeout(r, 1000));
            }
        }

        msgBox.textContent = "✅ Archivos procesados";
        msgBox.className = "message success";
        setTimeout(() => msgBox.remove(), 3000);

        // Limpieza final del DOM
        document.body.removeChild(fileInput);
    };

    // Disparar el selector
    fileInput.click();
}

// Renderiza la lista de archivos debajo del botón
function renderAdjuntosObra(obraId) {
    const cont = document.getElementById("adjuntos_" + obraId);
    const files = adjuntosObras[obraId] || [];

    const mensajes = cont.querySelectorAll(".message");

    let html = files.map((f, i) => `
        <div class="file-item">
            <span>📎 ${f.name}</span>
            <button type="button" onclick="eliminarAdjunto('${obraId}', ${i})" title="Eliminar adjunto">✖</button>
        </div>
    `).join("");

    cont.innerHTML = html;
    mensajes.forEach(m => cont.appendChild(m));
}

function eliminarAdjunto(obraId, index) {
    adjuntosObras[obraId].splice(index, 1);
    renderAdjuntosObra(obraId);
}

// ==========================================
// 4. LÓGICA DE ENVÍO PRINCIPAL (ADAPTADA)
// ==========================================

btnFirmar.addEventListener("click", async () => {
    try {
        btnFirmar.disabled = true;
        
        // ** NOTA IMPORTANTE: LA SUBIDA DE ADJUNTOS YA SE HIZO EN EL PASO 3 **
        // Por lo tanto, NO necesitamos la línea: const driveOk = await subirArchivos();
        
        mostrarMensaje("⏳ Registrando datos y generando justificante...", "info");

        // 1. Recopilar datos (JSON de Obras)
        // ASUME QUE LA FUNCIÓN getDatosObras() o similar existe y devuelve el JSON
        const datosObras = obtenerDatosDelFormularioObras(); 
        
        const nombreArchivosAdjuntos = [];
        // Recopilar todos los nombres de archivo de la variable global adjuntosObras
        for (const obraId in adjuntosObras) {
            adjuntosObras[obraId].forEach(file => nombreArchivosAdjuntos.push(file.name));
        }

        const userEmail = localStorage.getItem("userEmailActual");

        // 2. Crear el payload para el servicio de generación de PDF
        const payload = {
            tipo_formulario: "obras",
            datos_obras_json: JSON.stringify(datosObras),
            email_usuario: userEmail || "sin_email@ejemplo.com",
            municipio_codigo: MUNI_CODE,
            municipio_nombre: MUNI_NAME,
            timestamp_envio: new Date().toISOString(),
            archivos_adjuntos: nombreArchivosAdjuntos.join("\n"),
        };
        
        // 3. Enviar a URL_GENERAR_PDF
        const response = await fetch(URL_GENERAR_PDF, { 
            method: "POST",
            body: new URLSearchParams(payload)
        });

        // 4. Manejar la respuesta (Igual que en Cementerios)
        if (response.ok || response.status === 200) {
            const responseText = await response.text();
            let result = { success: false, message: "Éxito reportado por servidor (200 OK)." };
            
            try {
                result = JSON.parse(responseText); 
            } catch(e) {
                result.success = true; 
                result.message = "Éxito confirmado (200 OK).";
            }

            if (result.success) {
                mostrarMensaje("✅ Formulario enviado. Justificante generado y enviado por email.", "success");
                if (result.downloadUrl) {
                    window.open(result.downloadUrl, '_blank');
                }
                
                // Limpiar (solo las variables de archivos, los inputs se limpian aparte)
                adjuntosObras = {};
                
                // ASUME QUE LA FUNCIÓN limpiarFormularioObras() existe
                // limpiarFormularioObras(); 
            } else {
                mostrarMensaje(`❌ Error al generar justificante: ${result.message}`, "error");
                btnFirmar.disabled = false;
            }
        } else {
            const errorText = await response.text();
            mostrarMensaje(`❌ Error HTTP ${response.status}: ${errorText}`, "error");
            btnFirmar.disabled = false;
        }
    } catch(error) {
        console.error("Error completo:", error);
        mostrarMensaje(`❌ Error: ${error.message}`, "error");
        btnFirmar.disabled = false;
    }
});


// --- Control de acceso ---

// 1. Obtener las variables de sesión usando los nuevos nombres (que hemos guardado en index.html)
const userEmail = localStorage.getItem("userEmailActual");
const codigoMuniLogueado = localStorage.getItem("municipioCodigoActual");

// 2. Comprobación básica de sesión
// Si no tenemos el email O el código de municipio, redirigimos al login.
if (!userEmail || !codigoMuniLogueado) {
  window.location.href = "../login.html";
}

document.addEventListener("DOMContentLoaded", () => {
    // La variable MUNI_CODE ya viene del servidor (template Jinja) con el código del formulario actual.
    const formMunicipioCodigo = MUNI_CODE;

    // 3. Actualizar la UI (opcional)
    const muniName = document.getElementById("muniName");
    if (muniName) {
        // Usamos la clave guardada en el index.html
        muniName.textContent = localStorage.getItem("municipioNombreActual") || formMunicipioCodigo;
    }

    // 4. Comprobación de Autorización (el usuario logueado puede acceder a este formulario)
    if (codigoMuniLogueado !== formMunicipioCodigo) {
        alert("No tienes permiso para acceder a este municipio. Estás logueado como municipio " + codigoMuniLogueado);
        // Además, eliminamos el estado de sesión para forzar un nuevo login limpio.
        localStorage.clear(); 
        window.location.href = "../login.html";
    }
});
</script>
</body>