<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Formulario Obras - 047</title>
<style>
body {
  font-family: Arial, sans-serif;
  background: #f4f4f4;
  padding: 20px;
}
.container {
  background: white;
  padding: 20px;
  border-radius: 8px;
  max-width: 900px;
  margin: auto;
  box-shadow: 0 0 10px rgba(0,0,0,0.1);
}
table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 15px;
}
table th, table td {
  padding: 10px;
  border: 1px solid #ccc;
}
th {
  background: #eee;
}
select, input[type="checkbox"] {
  font-size: 14px;
}
button {
  padding: 12px;
  font-size: 16px;
  margin-top: 20px;
  width: 100%;
  background: #1976d2;
  color: white;
  border: none;
  border-radius: 6px;
  cursor: pointer;
}
button:hover {
  background: #125ea3;
}
</style>
</head>

<body>
<div class="container">

<h2>Formulario de Obras - 047 (047)</h2>

<form id="frmObras">

<table>
<thead>
<tr>
  <th>Obra</th>
  <th>Plan</th>
  <th>Estado obra</th>
  <th>Adjunta Proyecto</th>
</tr>
</thead>

<tbody>

<tr>
  <td>IES (03016547). NUEVA CONSTRUCCIÓN.</td>
  <td>GVA (PROGRAMA EDIFICANT)</td>

  <td>
    
      <select name="estado_1">
        <option value="">-- Seleccione --</option>
        <option>No iniciada</option>
        <option>En ejecución</option>
        <option>Paralizada</option>
        <option>Finalizada</option>
        <option>Anulada</option>
      </select>
    
  </td>

  <td>
    
    <button type="button" onclick="subirAdjunto('047', '1')">
        Adjuntar
    </button>
    <div id="adjuntos_1" style="font-size:13px; margin-top:4px;"></div>
    
    </td>
</tr>

<tr>
  <td>Obras de adaptación de parcela y dotación de servicios, para la instalación provisional de módulos prefabricados para C.E.I.P. e I.E.S. de Calp</td>
  <td>None</td>

  <td>
    
      <select name="estado_2">
        <option value="">-- Seleccione --</option>
        <option>No iniciada</option>
        <option>En ejecución</option>
        <option>Paralizada</option>
        <option>Finalizada</option>
        <option>Anulada</option>
      </select>
    
  </td>

  <td>
    
    <button type="button" onclick="subirAdjunto('047', '2')">
        Adjuntar
    </button>
    <div id="adjuntos_2" style="font-size:13px; margin-top:4px;"></div>
    
    </td>
</tr>

<tr>
  <td>CEIP AZORÍN (03010892). ACTUACIONS REFERIDES A CONSTRUCCIO GIMNAS I ADEQUACIO CASA CONSERGE.</td>
  <td>GVA (PROGRAMA EDIFICANT)</td>

  <td>
    
      <select name="estado_3">
        <option value="">-- Seleccione --</option>
        <option>No iniciada</option>
        <option>En ejecución</option>
        <option>Paralizada</option>
        <option>Finalizada</option>
        <option>Anulada</option>
      </select>
    
  </td>

  <td>
    
    <button type="button" onclick="subirAdjunto('047', '3')">
        Adjuntar
    </button>
    <div id="adjuntos_3" style="font-size:13px; margin-top:4px;"></div>
    
    </td>
</tr>

<tr>
  <td>ADECUACIÓN DE LA EDAR DE EMPEDROLA II EN CALPE (ALICANTE)</td>
  <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

  <td>
    
      <select name="estado_4">
        <option value="">-- Seleccione --</option>
        <option>No iniciada</option>
        <option>En ejecución</option>
        <option>Paralizada</option>
        <option>Finalizada</option>
        <option>Anulada</option>
      </select>
    
  </td>

  <td>
    
    <button type="button" onclick="subirAdjunto('047', '4')">
        Adjuntar
    </button>
    <div id="adjuntos_4" style="font-size:13px; margin-top:4px;"></div>
    
    </td>
</tr>

<tr>
  <td>CONSTRUCCIÓN DE UNA NUEVA CAPTACIÓN DE ABASTECIMIENTO DE AGUA POTABLE A CALP EN EL T.M. DE LA VALL DE LAGUAR PARA LA MANCOMUNIDAD DE CALPE, MURLA Y VALL DE LAGUAR-POZO LUCIFER (EXPTE. 2024/008-AACH).</td>
  <td>REALIZACIÓN Y MEJORA INFRAS DE ABAST. EN ALTA, CAPTACIÓN Y REGULACIÓN A EJEC. LA DIPUTACIÓN 2024 BOP: 07/01/2025</td>

  <td>
    
      <select name="estado_5">
        <option value="">-- Seleccione --</option>
        <option>No iniciada</option>
        <option>En ejecución</option>
        <option>Paralizada</option>
        <option>Finalizada</option>
        <option>Anulada</option>
      </select>
    
  </td>

  <td>
    
    <button type="button" onclick="subirAdjunto('047', '5')">
        Adjuntar
    </button>
    <div id="adjuntos_5" style="font-size:13px; margin-top:4px;"></div>
    
    </td>
</tr>

<tr>
  <td>CAMBIO DE CONDUCCIONES DE ENTRADA Y ACTUALIZACIÓN DE LA CÁMARA DE LLAVES EN EL DEPÓSITO DE MASCARAT-TOIX EN CALP (ALICANTE)</td>
  <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

  <td>
    
      <select name="estado_6">
        <option value="">-- Seleccione --</option>
        <option>No iniciada</option>
        <option>En ejecución</option>
        <option>Paralizada</option>
        <option>Finalizada</option>
        <option>Anulada</option>
      </select>
    
  </td>

  <td>
    
    <button type="button" onclick="subirAdjunto('047', '6')">
        Adjuntar
    </button>
    <div id="adjuntos_6" style="font-size:13px; margin-top:4px;"></div>
    
    </td>
</tr>

<tr>
  <td>REASFALTADO DE URBANIZACIONES DE CALP (ALICANTE): FASE III - REASFALTADO EN LAS PARTIDAS TOSSAL, ESTACIÓN I Y CUCARRES.</td>
  <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

  <td>
    
      <select name="estado_7">
        <option value="">-- Seleccione --</option>
        <option>No iniciada</option>
        <option>En ejecución</option>
        <option>Paralizada</option>
        <option>Finalizada</option>
        <option>Anulada</option>
      </select>
    
  </td>

  <td>
    
    <button type="button" onclick="subirAdjunto('047', '7')">
        Adjuntar
    </button>
    <div id="adjuntos_7" style="font-size:13px; margin-top:4px;"></div>
    
    </td>
</tr>

<tr>
  <td>REPARACIÓN Y ADECUACIÓN CUBIERTA DEPÓSITO OLTÁ</td>
  <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

  <td>
    
      <select name="estado_8">
        <option value="">-- Seleccione --</option>
        <option>No iniciada</option>
        <option>En ejecución</option>
        <option>Paralizada</option>
        <option>Finalizada</option>
        <option>Anulada</option>
      </select>
    
  </td>

  <td>
    
    <button type="button" onclick="subirAdjunto('047', '8')">
        Adjuntar
    </button>
    <div id="adjuntos_8" style="font-size:13px; margin-top:4px;"></div>
    
    </td>
</tr>

<tr>
  <td>CEE PÚB. GARGASINDI (03010776). CONSTRUCCIÓN/REPOSICIÓN CON AMPLIACIÓN DE PARCELA Y DEMOLICIÓN EDIFICIOS EXISTENTES.</td>
  <td>GVA (PROGRAMA EDIFICANT)</td>

  <td>
    
      <select name="estado_9">
        <option value="">-- Seleccione --</option>
        <option>No iniciada</option>
        <option>En ejecución</option>
        <option>Paralizada</option>
        <option>Finalizada</option>
        <option>Anulada</option>
      </select>
    
  </td>

  <td>
    
    <button type="button" onclick="subirAdjunto('047', '9')">
        Adjuntar
    </button>
    <div id="adjuntos_9" style="font-size:13px; margin-top:4px;"></div>
    
    </td>
</tr>

<tr>
  <td>REALIZACIÓN DE OBRA CIVIL Y MONTAJE DE CONDUCCIONES EN LA OBRA DE RENOVACIÓN DE CONDUCCIONES DE AGUA POTABLE EN PARTIDA SENIETA DE CALP (ALICANTE)</td>
  <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

  <td>
    
      <select name="estado_10">
        <option value="">-- Seleccione --</option>
        <option>No iniciada</option>
        <option>En ejecución</option>
        <option>Paralizada</option>
        <option>Finalizada</option>
        <option>Anulada</option>
      </select>
    
  </td>

  <td>
    
    <button type="button" onclick="subirAdjunto('047', '10')">
        Adjuntar
    </button>
    <div id="adjuntos_10" style="font-size:13px; margin-top:4px;"></div>
    
    </td>
</tr>

<tr>
  <td>REALIZACIÓN DE OBRA CIVIL Y MONTAJE DE CONDUCCIONES EN LA OBRA DE ADECUACIÓN DE LA RED DE DISTRIBUCIÓN DE LA URBANIZACIÓN CALPE PARK</td>
  <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

  <td>
    
      <select name="estado_11">
        <option value="">-- Seleccione --</option>
        <option>No iniciada</option>
        <option>En ejecución</option>
        <option>Paralizada</option>
        <option>Finalizada</option>
        <option>Anulada</option>
      </select>
    
  </td>

  <td>
    
    <button type="button" onclick="subirAdjunto('047', '11')">
        Adjuntar
    </button>
    <div id="adjuntos_11" style="font-size:13px; margin-top:4px;"></div>
    
    </td>
</tr>

<tr>
  <td>ADECUACIÓN DE LA RED DE PLUVIALES EN AVDA. JUAN CARLOS I Y CALLE XALOC DE CALP (ALICANTE)</td>
  <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

  <td>
    
      <select name="estado_12">
        <option value="">-- Seleccione --</option>
        <option>No iniciada</option>
        <option>En ejecución</option>
        <option>Paralizada</option>
        <option>Finalizada</option>
        <option>Anulada</option>
      </select>
    
  </td>

  <td>
    
    <button type="button" onclick="subirAdjunto('047', '12')">
        Adjuntar
    </button>
    <div id="adjuntos_12" style="font-size:13px; margin-top:4px;"></div>
    
    </td>
</tr>

<tr>
  <td>REHABILITACIÓN CON MANGA AUTOPORTANTE DE UN TRAMO DE LA RED DE SANEAMIENTO EN AVDA. EJÉRCITOS ESPAÑOLES. CALP (ALICANTE)</td>
  <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

  <td>
    
      <select name="estado_13">
        <option value="">-- Seleccione --</option>
        <option>No iniciada</option>
        <option>En ejecución</option>
        <option>Paralizada</option>
        <option>Finalizada</option>
        <option>Anulada</option>
      </select>
    
  </td>

  <td>
    
    <button type="button" onclick="subirAdjunto('047', '13')">
        Adjuntar
    </button>
    <div id="adjuntos_13" style="font-size:13px; margin-top:4px;"></div>
    
    </td>
</tr>

<tr>
  <td>REMODELACIÓN INSTALACIONES DESALADORA BARRANC SALAT DEL MUNICIPIO DE CALP (ALICANTE)</td>
  <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

  <td>
    
      <select name="estado_14">
        <option value="">-- Seleccione --</option>
        <option>No iniciada</option>
        <option>En ejecución</option>
        <option>Paralizada</option>
        <option>Finalizada</option>
        <option>Anulada</option>
      </select>
    
  </td>

  <td>
    
    <button type="button" onclick="subirAdjunto('047', '14')">
        Adjuntar
    </button>
    <div id="adjuntos_14" style="font-size:13px; margin-top:4px;"></div>
    
    </td>
</tr>

<tr>
  <td>REALIZACIÓN DE OBRA CIVIL Y MONTAJE DE CONDUCCIONES  EN LA OBRA DE RENOVACIÓN DE CONDUCCIONES DE AGUA POTABLE EN LA PARTIDA ESTACIÓN II DE CALP (ALICANTE)</td>
  <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

  <td>
    
      <select name="estado_15">
        <option value="">-- Seleccione --</option>
        <option>No iniciada</option>
        <option>En ejecución</option>
        <option>Paralizada</option>
        <option>Finalizada</option>
        <option>Anulada</option>
      </select>
    
  </td>

  <td>
    
    <button type="button" onclick="subirAdjunto('047', '15')">
        Adjuntar
    </button>
    <div id="adjuntos_15" style="font-size:13px; margin-top:4px;"></div>
    
    </td>
</tr>

<tr>
  <td>PROYECTO DE REBOMBEO DE LA ETAP ORBA (ALICANTE)</td>
  <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

  <td>
    
      <select name="estado_16">
        <option value="">-- Seleccione --</option>
        <option>No iniciada</option>
        <option>En ejecución</option>
        <option>Paralizada</option>
        <option>Finalizada</option>
        <option>Anulada</option>
      </select>
    
  </td>

  <td>
    
    <button type="button" onclick="subirAdjunto('047', '16')">
        Adjuntar
    </button>
    <div id="adjuntos_16" style="font-size:13px; margin-top:4px;"></div>
    
    </td>
</tr>

<tr>
  <td>REASFALTADO DE URBANIZACIONES DE CALP (ALICANTE): FASE V - REASFALTADO EN LAS PARTIDAS LA MERCED, GRAN SOL Y LA CALETA</td>
  <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

  <td>
    
      <select name="estado_17">
        <option value="">-- Seleccione --</option>
        <option>No iniciada</option>
        <option>En ejecución</option>
        <option>Paralizada</option>
        <option>Finalizada</option>
        <option>Anulada</option>
      </select>
    
  </td>

  <td>
    
    <button type="button" onclick="subirAdjunto('047', '17')">
        Adjuntar
    </button>
    <div id="adjuntos_17" style="font-size:13px; margin-top:4px;"></div>
    
    </td>
</tr>

<tr>
  <td>REMODELACIÓN DEL DEPÓSITO DE ESTACIÓN EN CALPE (ALICANTE).</td>
  <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

  <td>
    
      <select name="estado_18">
        <option value="">-- Seleccione --</option>
        <option>No iniciada</option>
        <option>En ejecución</option>
        <option>Paralizada</option>
        <option>Finalizada</option>
        <option>Anulada</option>
      </select>
    
  </td>

  <td>
    
    <button type="button" onclick="subirAdjunto('047', '18')">
        Adjuntar
    </button>
    <div id="adjuntos_18" style="font-size:13px; margin-top:4px;"></div>
    
    </td>
</tr>

<tr>
  <td>REFORMA DE LA SALA DE USOS MÚLTIPLES, Y DE CONSTRUCCIÓN DE GIMNASIO EN EL CEIP AZORÍN DE CALP (ALICANTE)</td>
  <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

  <td>
    
      <select name="estado_19">
        <option value="">-- Seleccione --</option>
        <option>No iniciada</option>
        <option>En ejecución</option>
        <option>Paralizada</option>
        <option>Finalizada</option>
        <option>Anulada</option>
      </select>
    
  </td>

  <td>
    
    <button type="button" onclick="subirAdjunto('047', '19')">
        Adjuntar
    </button>
    <div id="adjuntos_19" style="font-size:13px; margin-top:4px;"></div>
    
    </td>
</tr>

<tr>
  <td>DEMOLICIÓN DE VIVIENDA ENTRE MEDIANERAS, Y DE CONSTRUCCIÓN DE LA OFICINA TURÍSTICA SIGLO XXI Y LA OFICINA DEL CENTRO COMERCIAL URBANO DE CALP (ALICANTE)</td>
  <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

  <td>
    
      <select name="estado_20">
        <option value="">-- Seleccione --</option>
        <option>No iniciada</option>
        <option>En ejecución</option>
        <option>Paralizada</option>
        <option>Finalizada</option>
        <option>Anulada</option>
      </select>
    
  </td>

  <td>
    
    <button type="button" onclick="subirAdjunto('047', '20')">
        Adjuntar
    </button>
    <div id="adjuntos_20" style="font-size:13px; margin-top:4px;"></div>
    
    </td>
</tr>

<tr>
  <td>OBRAS DE REPARACIÓN DEL ACCESO DE LA CALA BASSETES DE CALP (ALICANTE)</td>
  <td>Procedente de volcado de contratos menores de contrataciondelestado.es</td>

  <td>
    
      <select name="estado_21">
        <option value="">-- Seleccione --</option>
        <option>No iniciada</option>
        <option>En ejecución</option>
        <option>Paralizada</option>
        <option>Finalizada</option>
        <option>Anulada</option>
      </select>
    
  </td>

  <td>
    
    <button type="button" onclick="subirAdjunto('047', '21')">
        Adjuntar
    </button>
    <div id="adjuntos_21" style="font-size:13px; margin-top:4px;"></div>
    
    </td>
</tr>

<tr>
  <td>REASFALTADO DE LAS PARTIDAS EMPEDROLA I Y EMPEDROLA II, Y DE LA CALLE CASTELLÓN DE CALP (ALICANTE)</td>
  <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

  <td>
    
      <select name="estado_22">
        <option value="">-- Seleccione --</option>
        <option>No iniciada</option>
        <option>En ejecución</option>
        <option>Paralizada</option>
        <option>Finalizada</option>
        <option>Anulada</option>
      </select>
    
  </td>

  <td>
    
    <button type="button" onclick="subirAdjunto('047', '22')">
        Adjuntar
    </button>
    <div id="adjuntos_22" style="font-size:13px; margin-top:4px;"></div>
    
    </td>
</tr>

<tr>
  <td>OBRAS DE ADECUACIÓN DE PORCHE PARA COMEDOR Y ASEOS EN ALMACÉN MUNICIPAL DE CALP (ALICANTE)</td>
  <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

  <td>
    
      <select name="estado_23">
        <option value="">-- Seleccione --</option>
        <option>No iniciada</option>
        <option>En ejecución</option>
        <option>Paralizada</option>
        <option>Finalizada</option>
        <option>Anulada</option>
      </select>
    
  </td>

  <td>
    
    <button type="button" onclick="subirAdjunto('047', '23')">
        Adjuntar
    </button>
    <div id="adjuntos_23" style="font-size:13px; margin-top:4px;"></div>
    
    </td>
</tr>

<tr>
  <td>OBRAS DE REASFALTADO DE LAS ZONAS ESCOLARES DE CALP (ALICANTE)</td>
  <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

  <td>
    
      <select name="estado_24">
        <option value="">-- Seleccione --</option>
        <option>No iniciada</option>
        <option>En ejecución</option>
        <option>Paralizada</option>
        <option>Finalizada</option>
        <option>Anulada</option>
      </select>
    
  </td>

  <td>
    
    <button type="button" onclick="subirAdjunto('047', '24')">
        Adjuntar
    </button>
    <div id="adjuntos_24" style="font-size:13px; margin-top:4px;"></div>
    
    </td>
</tr>

<tr>
  <td>PROYECTO DE URBANIZACIÓN DEL VIAL T- S/PGOU</td>
  <td>PLAN PLANIFICA 2024-27 BOP: 14/06/2024</td>

  <td>
    
      <select name="estado_25">
        <option value="">-- Seleccione --</option>
        <option>No iniciada</option>
        <option>En ejecución</option>
        <option>Paralizada</option>
        <option>Finalizada</option>
        <option>Anulada</option>
      </select>
    
  </td>

  <td>
    
    <button type="button" onclick="subirAdjunto('047', '25')">
        Adjuntar
    </button>
    <div id="adjuntos_25" style="font-size:13px; margin-top:4px;"></div>
    
    </td>
</tr>

<tr>
  <td>LUMINARIAS SOLARES EN CAMINOS DE LAS HUERTAS, REDUCTORES DE VELOCIDAD EN LLANO PASTORES Y PISNELLA</td>
  <td>ADQUISICIÓN DE LUMINARIAS Y ELEM. DE SEG. VIAL EN VÍAS Y CAMINOS, POB.  <20000 HAB. 2024. BOP: 19/07/2024.</td>

  <td>
    
      <select name="estado_26">
        <option value="">-- Seleccione --</option>
        <option>No iniciada</option>
        <option>En ejecución</option>
        <option>Paralizada</option>
        <option>Finalizada</option>
        <option>Anulada</option>
      </select>
    
  </td>

  <td>
    
    <button type="button" onclick="subirAdjunto('047', '26')">
        Adjuntar
    </button>
    <div id="adjuntos_26" style="font-size:13px; margin-top:4px;"></div>
    
    </td>
</tr>

<tr>
  <td>ADECUACIÓN DE ZONAS ADYACENTES AL VIAL J EN T.M. DE CALP (ALICANTE)</td>
  <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

  <td>
    
      <select name="estado_27">
        <option value="">-- Seleccione --</option>
        <option>No iniciada</option>
        <option>En ejecución</option>
        <option>Paralizada</option>
        <option>Finalizada</option>
        <option>Anulada</option>
      </select>
    
  </td>

  <td>
    
    <button type="button" onclick="subirAdjunto('047', '27')">
        Adjuntar
    </button>
    <div id="adjuntos_27" style="font-size:13px; margin-top:4px;"></div>
    
    </td>
</tr>

<tr>
  <td>REPARACIÓN DEL DEPÓSITO DE AGUA POTABLE DE CASANOVA</td>
  <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

  <td>
    
      <select name="estado_28">
        <option value="">-- Seleccione --</option>
        <option>No iniciada</option>
        <option>En ejecución</option>
        <option>Paralizada</option>
        <option>Finalizada</option>
        <option>Anulada</option>
      </select>
    
  </td>

  <td>
    
    <button type="button" onclick="subirAdjunto('047', '28')">
        Adjuntar
    </button>
    <div id="adjuntos_28" style="font-size:13px; margin-top:4px;"></div>
    
    </td>
</tr>

<tr>
  <td>REALIZACIÓN DE OBRA CIVIL Y MONTAJE DE CONDUCCIONES EN LA OBRA DE RENOVACIÓN DE CONDUCCIONES DE IMPULSIÓN Y DISTRIBUCIÓN EN EL TRAMO ESTACIÓN-OLTÁ DE CALP (ALICANTE)</td>
  <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

  <td>
    
      <select name="estado_29">
        <option value="">-- Seleccione --</option>
        <option>No iniciada</option>
        <option>En ejecución</option>
        <option>Paralizada</option>
        <option>Finalizada</option>
        <option>Anulada</option>
      </select>
    
  </td>

  <td>
    
    <button type="button" onclick="subirAdjunto('047', '29')">
        Adjuntar
    </button>
    <div id="adjuntos_29" style="font-size:13px; margin-top:4px;"></div>
    
    </td>
</tr>

<tr>
  <td>REALIZACIÓN DE OBRA CIVIL Y MONTAJE DE CONDUCCIONES EN LA OBRA DE DESVÍO DE LA RED DE DISTRIBUCIÓN DE AGUA POTABLE EN LA PARTIDA COLINA DEL SOL, CALPE (ALICANTE)</td>
  <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

  <td>
    
      <select name="estado_30">
        <option value="">-- Seleccione --</option>
        <option>No iniciada</option>
        <option>En ejecución</option>
        <option>Paralizada</option>
        <option>Finalizada</option>
        <option>Anulada</option>
      </select>
    
  </td>

  <td>
    
    <button type="button" onclick="subirAdjunto('047', '30')">
        Adjuntar
    </button>
    <div id="adjuntos_30" style="font-size:13px; margin-top:4px;"></div>
    
    </td>
</tr>

<tr>
  <td>REHABILITACIÓN DE LA CASA BELTRÁN PARA CREAR EL MUSEU DE LA FESTA</td>
  <td>PLAN TERRITORIAL DE SOSTENIBILIDAD TURÍSTICA EN DESTINO COMUNITAT VALENCIANA 2023 (PTSTD CV 23)</td>

  <td>
    
      <select name="estado_31">
        <option value="">-- Seleccione --</option>
        <option>No iniciada</option>
        <option>En ejecución</option>
        <option>Paralizada</option>
        <option>Finalizada</option>
        <option>Anulada</option>
      </select>
    
  </td>

  <td>
    
    <button type="button" onclick="subirAdjunto('047', '31')">
        Adjuntar
    </button>
    <div id="adjuntos_31" style="font-size:13px; margin-top:4px;"></div>
    
    </td>
</tr>

<tr>
  <td>REALIZACIÓN DE OBRA CIVIL Y MONTAJE DE CONDUCCIONES EN LA OBRA DE DIVERSOS TRAMOS DE LA RED DE DISTRIBUCIÓN DE AGUA POTABLE EN LA PARTIDA MARYVILLA, CALPE (ALICANTE)</td>
  <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

  <td>
    
      <select name="estado_32">
        <option value="">-- Seleccione --</option>
        <option>No iniciada</option>
        <option>En ejecución</option>
        <option>Paralizada</option>
        <option>Finalizada</option>
        <option>Anulada</option>
      </select>
    
  </td>

  <td>
    
    <button type="button" onclick="subirAdjunto('047', '32')">
        Adjuntar
    </button>
    <div id="adjuntos_32" style="font-size:13px; margin-top:4px;"></div>
    
    </td>
</tr>

<tr>
  <td>CONSOLIDACIÓN DE CARRILES BICI E ITINERARIOS PEATONALES EN LAS AVENIDAS DE ACCESO A LAS PLAYAS</td>
  <td>PLAN TERRITORIAL DE SOSTENIBILIDAD TURÍSTICA EN DESTINO COMUNITAT VALENCIANA 2023 (PTSTD CV 23)</td>

  <td>
    
      <select name="estado_33">
        <option value="">-- Seleccione --</option>
        <option>No iniciada</option>
        <option>En ejecución</option>
        <option>Paralizada</option>
        <option>Finalizada</option>
        <option>Anulada</option>
      </select>
    
  </td>

  <td>
    
    <button type="button" onclick="subirAdjunto('047', '33')">
        Adjuntar
    </button>
    <div id="adjuntos_33" style="font-size:13px; margin-top:4px;"></div>
    
    </td>
</tr>

<tr>
  <td>MODIFICACIÓN DE ACCESO DE EDIFICIO SITUADO EN AVDA. PUERTO DE SANTAMARÍA, 7 DE CALP (ALICANTE)</td>
  <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

  <td>
    
      <select name="estado_34">
        <option value="">-- Seleccione --</option>
        <option>No iniciada</option>
        <option>En ejecución</option>
        <option>Paralizada</option>
        <option>Finalizada</option>
        <option>Anulada</option>
      </select>
    
  </td>

  <td>
    
    <button type="button" onclick="subirAdjunto('047', '34')">
        Adjuntar
    </button>
    <div id="adjuntos_34" style="font-size:13px; margin-top:4px;"></div>
    
    </td>
</tr>

<tr>
  <td>MANTENIMIENTO Y ADECUACIÓN DEL PASEO DE LA PLAYA ARENAL-BOL DE CALP (ALICANTE)</td>
  <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

  <td>
    
      <select name="estado_35">
        <option value="">-- Seleccione --</option>
        <option>No iniciada</option>
        <option>En ejecución</option>
        <option>Paralizada</option>
        <option>Finalizada</option>
        <option>Anulada</option>
      </select>
    
  </td>

  <td>
    
    <button type="button" onclick="subirAdjunto('047', '35')">
        Adjuntar
    </button>
    <div id="adjuntos_35" style="font-size:13px; margin-top:4px;"></div>
    
    </td>
</tr>

<tr>
  <td>REFORMA DE LOCAL PARA LA SEDE DE PROTECCIÓN CIVIL DE CALP (ALICANTE)</td>
  <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

  <td>
    
      <select name="estado_36">
        <option value="">-- Seleccione --</option>
        <option>No iniciada</option>
        <option>En ejecución</option>
        <option>Paralizada</option>
        <option>Finalizada</option>
        <option>Anulada</option>
      </select>
    
  </td>

  <td>
    
    <button type="button" onclick="subirAdjunto('047', '36')">
        Adjuntar
    </button>
    <div id="adjuntos_36" style="font-size:13px; margin-top:4px;"></div>
    
    </td>
</tr>

<tr>
  <td>RECONSTRUCCIÓN DEL VIAL DE ACCESO A LA URBANIZACIÓN BALCÓN DE BERNIA EN CALP (ALICANTE)</td>
  <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

  <td>
    
      <select name="estado_37">
        <option value="">-- Seleccione --</option>
        <option>No iniciada</option>
        <option>En ejecución</option>
        <option>Paralizada</option>
        <option>Finalizada</option>
        <option>Anulada</option>
      </select>
    
  </td>

  <td>
    
    <button type="button" onclick="subirAdjunto('047', '37')">
        Adjuntar
    </button>
    <div id="adjuntos_37" style="font-size:13px; margin-top:4px;"></div>
    
    </td>
</tr>

<tr>
  <td>OBRAS DE REASFALTADO DE LAS PARTIDAS BASSETES, CALALGA, CALETA Y LA FOSSA EN CALP (ALICANTE)</td>
  <td>Procedente de volcado de licitaciones de contrataciondelestado.es</td>

  <td>
    
      <select name="estado_38">
        <option value="">-- Seleccione --</option>
        <option>No iniciada</option>
        <option>En ejecución</option>
        <option>Paralizada</option>
        <option>Finalizada</option>
        <option>Anulada</option>
      </select>
    
  </td>

  <td>
    
    <button type="button" onclick="subirAdjunto('047', '38')">
        Adjuntar
    </button>
    <div id="adjuntos_38" style="font-size:13px; margin-top:4px;"></div>
    
    </td>
</tr>

</tbody>
</table>

<button type="submit">Enviar</button>
</form>

</div>

<script>
// ------------------------
// CONFIGURACIÓN
// ------------------------
const URL_APPS_SCRIPT = "https://script.google.com/macros/s/AKfycbyaYoePvbzj5ZntRPB8ZFO8AHOmJtUNtDiwiD9Au7BSniFZE5pFHeyGMd0VaLSy-VFknQ/exec"; 
const URL_GOOGLE_FORMS = "https://docs.google.com/forms/d/e/1FAIpQLSc84PLY4O2wM9ek3v6L14DzZ8jcqDtFeKOK01i38s7ttPt0Ng/formResponse";

// Almacén local de archivos para mostrar en la lista antes de enviar el formulario final
let adjuntosObras = {};

// ------------------------
// UTILIDADES (Base64)
// ------------------------
function getBase64(file) {
  return new Promise((resolve, reject) => {
    const reader = new FileReader();
    reader.readAsDataURL(file);
    reader.onload = () => {
      // Quitamos la cabecera "data:image/png;base64,"
      let encoded = reader.result.toString().replace(/^data:(.*,)?/, '');
      if ((encoded.length % 4) > 0) {
        encoded += '='.repeat(4 - (encoded.length % 4));
      }
      resolve(encoded);
    };
    reader.onerror = error => reject(error);
  });
}

// ------------------------
// GESTIÓN DE INTERFAZ (Listado de archivos)
// ------------------------
function renderAdjuntosObra(obraId) {
  const cont = document.getElementById("adjuntos_" + obraId);
  const files = adjuntosObras[obraId] || [];

  // Mantenemos el div de estado si existe, o limpiamos para repintar la lista
  // Para simplificar, repintamos la lista y dejamos espacio para mensajes
  
  // Guardar mensajes temporales si los hubiera
  const existingMsgs = Array.from(cont.querySelectorAll('.msg-status'));
  
  cont.innerHTML = files
    .map((f, i) => `
      <div style="display:flex; align-items:center; gap:6px; margin-top:3px; background:#f9f9f9; padding:2px 5px; border-radius:4px;">
        <span style="font-size:12px;">📎 ${f.name}</span>
        <button 
          type="button" 
          onclick="eliminarAdjunto('${obraId}', ${i})"
          style="background:none; color:#b71c1c; border:none; font-size:12px; cursor:pointer; padding:0;"
          title="Eliminar de la lista (no borra de Drive)"
        >
          ✖
        </button>
      </div>
    `)
    .join("");

  // Re-insertar mensajes de estado (cargando/exito) al final
  existingMsgs.forEach(msg => cont.appendChild(msg));
}

function eliminarAdjunto(obraId, index) {
  adjuntosObras[obraId].splice(index, 1);
  renderAdjuntosObra(obraId);
}

// ------------------------
// LÓGICA DE SUBIDA (AJAX + JSON)
// ------------------------
async function subirAdjunto(munCode, obraId) {
  const fileInput = document.createElement("input");
  fileInput.type = "file";
  fileInput.multiple = true;
  // fileInput.accept = ".pdf,.jpg,.jpeg,.png,.doc,.docx"; // Opcional: limitar tipos

  fileInput.onchange = async () => {
    const files = Array.from(fileInput.files);
    if (!files.length) return;

    // 1. Añadir a la lista visual inmediatamente
    if (!adjuntosObras[obraId]) adjuntosObras[obraId] = [];
    adjuntosObras[obraId].push(...files);
    renderAdjuntosObra(obraId);

    // 2. Preparar zona de mensajes
    const statusDiv = document.getElementById("adjuntos_" + obraId);
    const msgBox = document.createElement("div");
    msgBox.className = "msg-status";
    msgBox.style.fontSize = "11px";
    msgBox.style.marginTop = "4px";
    msgBox.style.fontWeight = "bold";
    statusDiv.appendChild(msgBox);

    // 3. Subir archivos UNO A UNO
    for (let i = 0; i < files.length; i++) {
      const file = files[i];
      msgBox.textContent = `⏳ Subiendo ${i+1}/${files.length}: ${file.name}...`;
      msgBox.style.color = "#f57c00"; // Naranja

      try {
        // A. Convertir
        const base64 = await getBase64(file);

        // B. Payload JSON
        const payload = {
          tipo: "obra",      // Importante para tu script
          mun: munCode,
          obra: obraId,      // El ID o índice de la obra (para la subcarpeta)
          filename: file.name,
          mimeType: file.type,
          file: base64
        };

        // C. Enviar
        const resp = await fetch(URL_APPS_SCRIPT, {
          method: "POST",
          body: JSON.stringify(payload)
        });
        
        const data = await resp.json();

        if (data.status === "success") {
          console.log(`✅ ${file.name} subido.`);
        } else {
          throw new Error(data.message || "Error desconocido");
        }

      } catch (err) {
        console.error(err);
        msgBox.textContent = `❌ Error con ${file.name}`;
        msgBox.style.color = "red";
        // Pausa para leer el error antes de seguir
        await new Promise(r => setTimeout(r, 2000));
      }
    }

    // 4. Finalización
    msgBox.textContent = "✅ Todos los archivos subidos.";
    msgBox.style.color = "green";
    
    // Borrar mensaje de éxito tras 4 segundos
    setTimeout(() => {
      try { msgBox.remove(); } catch(e){}
    }, 4000);
  };

  fileInput.click();
}


// ------------------------
// ENVIAR FORMULARIO FINAL (DATOS A GOOGLE FORM)
// ------------------------
document.getElementById("frmObras").addEventListener("submit", async (e) => {
  e.preventDefault();
  
  const btnSubmit = e.target.querySelector("button[type='submit']");
  const originalText = btnSubmit.textContent;
  btnSubmit.disabled = true;
  btnSubmit.textContent = "Enviando datos...";

  // Recopilar estados de las obras
  const estados = [];
  const form = e.target;
  
  // NOTA: Asegúrate de que este bucle de Jinja2 renderiza correctamente los índices
  // JS no interpreta Jinja, esto debe venir renderizado del servidor.
  
    
      // Capturamos el valor del select
      const select1 = form.querySelector('[name="estado_1"]');
      const val1 = select1 ? select1.value : "";
      
      estados.push({
        obra: "IES (03016547). NUEVA CONSTRUCCIÓN.",
        plan: "GVA (PROGRAMA EDIFICANT)",
        estado: val1,
        archivos: (adjuntosObras["1"] || []).map(f => f.name)
      });
    
  
    
      // Capturamos el valor del select
      const select2 = form.querySelector('[name="estado_2"]');
      const val2 = select2 ? select2.value : "";
      
      estados.push({
        obra: "Obras de adaptación de parcela y dotación de servicios, para la instalación provisional de módulos prefabricados para C.E.I.P. e I.E.S. de Calp",
        plan: "None",
        estado: val2,
        archivos: (adjuntosObras["2"] || []).map(f => f.name)
      });
    
  
    
      // Capturamos el valor del select
      const select3 = form.querySelector('[name="estado_3"]');
      const val3 = select3 ? select3.value : "";
      
      estados.push({
        obra: "CEIP AZORÍN (03010892). ACTUACIONS REFERIDES A CONSTRUCCIO GIMNAS I ADEQUACIO CASA CONSERGE.",
        plan: "GVA (PROGRAMA EDIFICANT)",
        estado: val3,
        archivos: (adjuntosObras["3"] || []).map(f => f.name)
      });
    
  
    
      // Capturamos el valor del select
      const select4 = form.querySelector('[name="estado_4"]');
      const val4 = select4 ? select4.value : "";
      
      estados.push({
        obra: "ADECUACIÓN DE LA EDAR DE EMPEDROLA II EN CALPE (ALICANTE)",
        plan: "Procedente de volcado de licitaciones de contrataciondelestado.es",
        estado: val4,
        archivos: (adjuntosObras["4"] || []).map(f => f.name)
      });
    
  
    
      // Capturamos el valor del select
      const select5 = form.querySelector('[name="estado_5"]');
      const val5 = select5 ? select5.value : "";
      
      estados.push({
        obra: "CONSTRUCCIÓN DE UNA NUEVA CAPTACIÓN DE ABASTECIMIENTO DE AGUA POTABLE A CALP EN EL T.M. DE LA VALL DE LAGUAR PARA LA MANCOMUNIDAD DE CALPE, MURLA Y VALL DE LAGUAR-POZO LUCIFER (EXPTE. 2024/008-AACH).",
        plan: "REALIZACIÓN Y MEJORA INFRAS DE ABAST. EN ALTA, CAPTACIÓN Y REGULACIÓN A EJEC. LA DIPUTACIÓN 2024 BOP: 07/01/2025",
        estado: val5,
        archivos: (adjuntosObras["5"] || []).map(f => f.name)
      });
    
  
    
      // Capturamos el valor del select
      const select6 = form.querySelector('[name="estado_6"]');
      const val6 = select6 ? select6.value : "";
      
      estados.push({
        obra: "CAMBIO DE CONDUCCIONES DE ENTRADA Y ACTUALIZACIÓN DE LA CÁMARA DE LLAVES EN EL DEPÓSITO DE MASCARAT-TOIX EN CALP (ALICANTE)",
        plan: "Procedente de volcado de licitaciones de contrataciondelestado.es",
        estado: val6,
        archivos: (adjuntosObras["6"] || []).map(f => f.name)
      });
    
  
    
      // Capturamos el valor del select
      const select7 = form.querySelector('[name="estado_7"]');
      const val7 = select7 ? select7.value : "";
      
      estados.push({
        obra: "REASFALTADO DE URBANIZACIONES DE CALP (ALICANTE): FASE III - REASFALTADO EN LAS PARTIDAS TOSSAL, ESTACIÓN I Y CUCARRES.",
        plan: "Procedente de volcado de licitaciones de contrataciondelestado.es",
        estado: val7,
        archivos: (adjuntosObras["7"] || []).map(f => f.name)
      });
    
  
    
      // Capturamos el valor del select
      const select8 = form.querySelector('[name="estado_8"]');
      const val8 = select8 ? select8.value : "";
      
      estados.push({
        obra: "REPARACIÓN Y ADECUACIÓN CUBIERTA DEPÓSITO OLTÁ",
        plan: "Procedente de volcado de licitaciones de contrataciondelestado.es",
        estado: val8,
        archivos: (adjuntosObras["8"] || []).map(f => f.name)
      });
    
  
    
      // Capturamos el valor del select
      const select9 = form.querySelector('[name="estado_9"]');
      const val9 = select9 ? select9.value : "";
      
      estados.push({
        obra: "CEE PÚB. GARGASINDI (03010776). CONSTRUCCIÓN/REPOSICIÓN CON AMPLIACIÓN DE PARCELA Y DEMOLICIÓN EDIFICIOS EXISTENTES.",
        plan: "GVA (PROGRAMA EDIFICANT)",
        estado: val9,
        archivos: (adjuntosObras["9"] || []).map(f => f.name)
      });
    
  
    
      // Capturamos el valor del select
      const select10 = form.querySelector('[name="estado_10"]');
      const val10 = select10 ? select10.value : "";
      
      estados.push({
        obra: "REALIZACIÓN DE OBRA CIVIL Y MONTAJE DE CONDUCCIONES EN LA OBRA DE RENOVACIÓN DE CONDUCCIONES DE AGUA POTABLE EN PARTIDA SENIETA DE CALP (ALICANTE)",
        plan: "Procedente de volcado de licitaciones de contrataciondelestado.es",
        estado: val10,
        archivos: (adjuntosObras["10"] || []).map(f => f.name)
      });
    
  
    
      // Capturamos el valor del select
      const select11 = form.querySelector('[name="estado_11"]');
      const val11 = select11 ? select11.value : "";
      
      estados.push({
        obra: "REALIZACIÓN DE OBRA CIVIL Y MONTAJE DE CONDUCCIONES EN LA OBRA DE ADECUACIÓN DE LA RED DE DISTRIBUCIÓN DE LA URBANIZACIÓN CALPE PARK",
        plan: "Procedente de volcado de licitaciones de contrataciondelestado.es",
        estado: val11,
        archivos: (adjuntosObras["11"] || []).map(f => f.name)
      });
    
  
    
      // Capturamos el valor del select
      const select12 = form.querySelector('[name="estado_12"]');
      const val12 = select12 ? select12.value : "";
      
      estados.push({
        obra: "ADECUACIÓN DE LA RED DE PLUVIALES EN AVDA. JUAN CARLOS I Y CALLE XALOC DE CALP (ALICANTE)",
        plan: "Procedente de volcado de licitaciones de contrataciondelestado.es",
        estado: val12,
        archivos: (adjuntosObras["12"] || []).map(f => f.name)
      });
    
  
    
      // Capturamos el valor del select
      const select13 = form.querySelector('[name="estado_13"]');
      const val13 = select13 ? select13.value : "";
      
      estados.push({
        obra: "REHABILITACIÓN CON MANGA AUTOPORTANTE DE UN TRAMO DE LA RED DE SANEAMIENTO EN AVDA. EJÉRCITOS ESPAÑOLES. CALP (ALICANTE)",
        plan: "Procedente de volcado de licitaciones de contrataciondelestado.es",
        estado: val13,
        archivos: (adjuntosObras["13"] || []).map(f => f.name)
      });
    
  
    
      // Capturamos el valor del select
      const select14 = form.querySelector('[name="estado_14"]');
      const val14 = select14 ? select14.value : "";
      
      estados.push({
        obra: "REMODELACIÓN INSTALACIONES DESALADORA BARRANC SALAT DEL MUNICIPIO DE CALP (ALICANTE)",
        plan: "Procedente de volcado de licitaciones de contrataciondelestado.es",
        estado: val14,
        archivos: (adjuntosObras["14"] || []).map(f => f.name)
      });
    
  
    
      // Capturamos el valor del select
      const select15 = form.querySelector('[name="estado_15"]');
      const val15 = select15 ? select15.value : "";
      
      estados.push({
        obra: "REALIZACIÓN DE OBRA CIVIL Y MONTAJE DE CONDUCCIONES  EN LA OBRA DE RENOVACIÓN DE CONDUCCIONES DE AGUA POTABLE EN LA PARTIDA ESTACIÓN II DE CALP (ALICANTE)",
        plan: "Procedente de volcado de licitaciones de contrataciondelestado.es",
        estado: val15,
        archivos: (adjuntosObras["15"] || []).map(f => f.name)
      });
    
  
    
      // Capturamos el valor del select
      const select16 = form.querySelector('[name="estado_16"]');
      const val16 = select16 ? select16.value : "";
      
      estados.push({
        obra: "PROYECTO DE REBOMBEO DE LA ETAP ORBA (ALICANTE)",
        plan: "Procedente de volcado de licitaciones de contrataciondelestado.es",
        estado: val16,
        archivos: (adjuntosObras["16"] || []).map(f => f.name)
      });
    
  
    
      // Capturamos el valor del select
      const select17 = form.querySelector('[name="estado_17"]');
      const val17 = select17 ? select17.value : "";
      
      estados.push({
        obra: "REASFALTADO DE URBANIZACIONES DE CALP (ALICANTE): FASE V - REASFALTADO EN LAS PARTIDAS LA MERCED, GRAN SOL Y LA CALETA",
        plan: "Procedente de volcado de licitaciones de contrataciondelestado.es",
        estado: val17,
        archivos: (adjuntosObras["17"] || []).map(f => f.name)
      });
    
  
    
      // Capturamos el valor del select
      const select18 = form.querySelector('[name="estado_18"]');
      const val18 = select18 ? select18.value : "";
      
      estados.push({
        obra: "REMODELACIÓN DEL DEPÓSITO DE ESTACIÓN EN CALPE (ALICANTE).",
        plan: "Procedente de volcado de licitaciones de contrataciondelestado.es",
        estado: val18,
        archivos: (adjuntosObras["18"] || []).map(f => f.name)
      });
    
  
    
      // Capturamos el valor del select
      const select19 = form.querySelector('[name="estado_19"]');
      const val19 = select19 ? select19.value : "";
      
      estados.push({
        obra: "REFORMA DE LA SALA DE USOS MÚLTIPLES, Y DE CONSTRUCCIÓN DE GIMNASIO EN EL CEIP AZORÍN DE CALP (ALICANTE)",
        plan: "Procedente de volcado de licitaciones de contrataciondelestado.es",
        estado: val19,
        archivos: (adjuntosObras["19"] || []).map(f => f.name)
      });
    
  
    
      // Capturamos el valor del select
      const select20 = form.querySelector('[name="estado_20"]');
      const val20 = select20 ? select20.value : "";
      
      estados.push({
        obra: "DEMOLICIÓN DE VIVIENDA ENTRE MEDIANERAS, Y DE CONSTRUCCIÓN DE LA OFICINA TURÍSTICA SIGLO XXI Y LA OFICINA DEL CENTRO COMERCIAL URBANO DE CALP (ALICANTE)",
        plan: "Procedente de volcado de licitaciones de contrataciondelestado.es",
        estado: val20,
        archivos: (adjuntosObras["20"] || []).map(f => f.name)
      });
    
  
    
      // Capturamos el valor del select
      const select21 = form.querySelector('[name="estado_21"]');
      const val21 = select21 ? select21.value : "";
      
      estados.push({
        obra: "OBRAS DE REPARACIÓN DEL ACCESO DE LA CALA BASSETES DE CALP (ALICANTE)",
        plan: "Procedente de volcado de contratos menores de contrataciondelestado.es",
        estado: val21,
        archivos: (adjuntosObras["21"] || []).map(f => f.name)
      });
    
  
    
      // Capturamos el valor del select
      const select22 = form.querySelector('[name="estado_22"]');
      const val22 = select22 ? select22.value : "";
      
      estados.push({
        obra: "REASFALTADO DE LAS PARTIDAS EMPEDROLA I Y EMPEDROLA II, Y DE LA CALLE CASTELLÓN DE CALP (ALICANTE)",
        plan: "Procedente de volcado de licitaciones de contrataciondelestado.es",
        estado: val22,
        archivos: (adjuntosObras["22"] || []).map(f => f.name)
      });
    
  
    
      // Capturamos el valor del select
      const select23 = form.querySelector('[name="estado_23"]');
      const val23 = select23 ? select23.value : "";
      
      estados.push({
        obra: "OBRAS DE ADECUACIÓN DE PORCHE PARA COMEDOR Y ASEOS EN ALMACÉN MUNICIPAL DE CALP (ALICANTE)",
        plan: "Procedente de volcado de licitaciones de contrataciondelestado.es",
        estado: val23,
        archivos: (adjuntosObras["23"] || []).map(f => f.name)
      });
    
  
    
      // Capturamos el valor del select
      const select24 = form.querySelector('[name="estado_24"]');
      const val24 = select24 ? select24.value : "";
      
      estados.push({
        obra: "OBRAS DE REASFALTADO DE LAS ZONAS ESCOLARES DE CALP (ALICANTE)",
        plan: "Procedente de volcado de licitaciones de contrataciondelestado.es",
        estado: val24,
        archivos: (adjuntosObras["24"] || []).map(f => f.name)
      });
    
  
    
      // Capturamos el valor del select
      const select25 = form.querySelector('[name="estado_25"]');
      const val25 = select25 ? select25.value : "";
      
      estados.push({
        obra: "PROYECTO DE URBANIZACIÓN DEL VIAL T- S/PGOU",
        plan: "PLAN PLANIFICA 2024-27 BOP: 14/06/2024",
        estado: val25,
        archivos: (adjuntosObras["25"] || []).map(f => f.name)
      });
    
  
    
      // Capturamos el valor del select
      const select26 = form.querySelector('[name="estado_26"]');
      const val26 = select26 ? select26.value : "";
      
      estados.push({
        obra: "LUMINARIAS SOLARES EN CAMINOS DE LAS HUERTAS, REDUCTORES DE VELOCIDAD EN LLANO PASTORES Y PISNELLA",
        plan: "ADQUISICIÓN DE LUMINARIAS Y ELEM. DE SEG. VIAL EN VÍAS Y CAMINOS, POB.  <20000 HAB. 2024. BOP: 19/07/2024.",
        estado: val26,
        archivos: (adjuntosObras["26"] || []).map(f => f.name)
      });
    
  
    
      // Capturamos el valor del select
      const select27 = form.querySelector('[name="estado_27"]');
      const val27 = select27 ? select27.value : "";
      
      estados.push({
        obra: "ADECUACIÓN DE ZONAS ADYACENTES AL VIAL J EN T.M. DE CALP (ALICANTE)",
        plan: "Procedente de volcado de licitaciones de contrataciondelestado.es",
        estado: val27,
        archivos: (adjuntosObras["27"] || []).map(f => f.name)
      });
    
  
    
      // Capturamos el valor del select
      const select28 = form.querySelector('[name="estado_28"]');
      const val28 = select28 ? select28.value : "";
      
      estados.push({
        obra: "REPARACIÓN DEL DEPÓSITO DE AGUA POTABLE DE CASANOVA",
        plan: "Procedente de volcado de licitaciones de contrataciondelestado.es",
        estado: val28,
        archivos: (adjuntosObras["28"] || []).map(f => f.name)
      });
    
  
    
      // Capturamos el valor del select
      const select29 = form.querySelector('[name="estado_29"]');
      const val29 = select29 ? select29.value : "";
      
      estados.push({
        obra: "REALIZACIÓN DE OBRA CIVIL Y MONTAJE DE CONDUCCIONES EN LA OBRA DE RENOVACIÓN DE CONDUCCIONES DE IMPULSIÓN Y DISTRIBUCIÓN EN EL TRAMO ESTACIÓN-OLTÁ DE CALP (ALICANTE)",
        plan: "Procedente de volcado de licitaciones de contrataciondelestado.es",
        estado: val29,
        archivos: (adjuntosObras["29"] || []).map(f => f.name)
      });
    
  
    
      // Capturamos el valor del select
      const select30 = form.querySelector('[name="estado_30"]');
      const val30 = select30 ? select30.value : "";
      
      estados.push({
        obra: "REALIZACIÓN DE OBRA CIVIL Y MONTAJE DE CONDUCCIONES EN LA OBRA DE DESVÍO DE LA RED DE DISTRIBUCIÓN DE AGUA POTABLE EN LA PARTIDA COLINA DEL SOL, CALPE (ALICANTE)",
        plan: "Procedente de volcado de licitaciones de contrataciondelestado.es",
        estado: val30,
        archivos: (adjuntosObras["30"] || []).map(f => f.name)
      });
    
  
    
      // Capturamos el valor del select
      const select31 = form.querySelector('[name="estado_31"]');
      const val31 = select31 ? select31.value : "";
      
      estados.push({
        obra: "REHABILITACIÓN DE LA CASA BELTRÁN PARA CREAR EL MUSEU DE LA FESTA",
        plan: "PLAN TERRITORIAL DE SOSTENIBILIDAD TURÍSTICA EN DESTINO COMUNITAT VALENCIANA 2023 (PTSTD CV 23)",
        estado: val31,
        archivos: (adjuntosObras["31"] || []).map(f => f.name)
      });
    
  
    
      // Capturamos el valor del select
      const select32 = form.querySelector('[name="estado_32"]');
      const val32 = select32 ? select32.value : "";
      
      estados.push({
        obra: "REALIZACIÓN DE OBRA CIVIL Y MONTAJE DE CONDUCCIONES EN LA OBRA DE DIVERSOS TRAMOS DE LA RED DE DISTRIBUCIÓN DE AGUA POTABLE EN LA PARTIDA MARYVILLA, CALPE (ALICANTE)",
        plan: "Procedente de volcado de licitaciones de contrataciondelestado.es",
        estado: val32,
        archivos: (adjuntosObras["32"] || []).map(f => f.name)
      });
    
  
    
      // Capturamos el valor del select
      const select33 = form.querySelector('[name="estado_33"]');
      const val33 = select33 ? select33.value : "";
      
      estados.push({
        obra: "CONSOLIDACIÓN DE CARRILES BICI E ITINERARIOS PEATONALES EN LAS AVENIDAS DE ACCESO A LAS PLAYAS",
        plan: "PLAN TERRITORIAL DE SOSTENIBILIDAD TURÍSTICA EN DESTINO COMUNITAT VALENCIANA 2023 (PTSTD CV 23)",
        estado: val33,
        archivos: (adjuntosObras["33"] || []).map(f => f.name)
      });
    
  
    
      // Capturamos el valor del select
      const select34 = form.querySelector('[name="estado_34"]');
      const val34 = select34 ? select34.value : "";
      
      estados.push({
        obra: "MODIFICACIÓN DE ACCESO DE EDIFICIO SITUADO EN AVDA. PUERTO DE SANTAMARÍA, 7 DE CALP (ALICANTE)",
        plan: "Procedente de volcado de licitaciones de contrataciondelestado.es",
        estado: val34,
        archivos: (adjuntosObras["34"] || []).map(f => f.name)
      });
    
  
    
      // Capturamos el valor del select
      const select35 = form.querySelector('[name="estado_35"]');
      const val35 = select35 ? select35.value : "";
      
      estados.push({
        obra: "MANTENIMIENTO Y ADECUACIÓN DEL PASEO DE LA PLAYA ARENAL-BOL DE CALP (ALICANTE)",
        plan: "Procedente de volcado de licitaciones de contrataciondelestado.es",
        estado: val35,
        archivos: (adjuntosObras["35"] || []).map(f => f.name)
      });
    
  
    
      // Capturamos el valor del select
      const select36 = form.querySelector('[name="estado_36"]');
      const val36 = select36 ? select36.value : "";
      
      estados.push({
        obra: "REFORMA DE LOCAL PARA LA SEDE DE PROTECCIÓN CIVIL DE CALP (ALICANTE)",
        plan: "Procedente de volcado de licitaciones de contrataciondelestado.es",
        estado: val36,
        archivos: (adjuntosObras["36"] || []).map(f => f.name)
      });
    
  
    
      // Capturamos el valor del select
      const select37 = form.querySelector('[name="estado_37"]');
      const val37 = select37 ? select37.value : "";
      
      estados.push({
        obra: "RECONSTRUCCIÓN DEL VIAL DE ACCESO A LA URBANIZACIÓN BALCÓN DE BERNIA EN CALP (ALICANTE)",
        plan: "Procedente de volcado de licitaciones de contrataciondelestado.es",
        estado: val37,
        archivos: (adjuntosObras["37"] || []).map(f => f.name)
      });
    
  
    
      // Capturamos el valor del select
      const select38 = form.querySelector('[name="estado_38"]');
      const val38 = select38 ? select38.value : "";
      
      estados.push({
        obra: "OBRAS DE REASFALTADO DE LAS PARTIDAS BASSETES, CALALGA, CALETA Y LA FOSSA EN CALP (ALICANTE)",
        plan: "Procedente de volcado de licitaciones de contrataciondelestado.es",
        estado: val38,
        archivos: (adjuntosObras["38"] || []).map(f => f.name)
      });
    
  

  // Enviar a Google Forms
  const formData = new FormData();
  formData.append("entry.1317069794", "047"); 
  formData.append("entry.1523598469", JSON.stringify(estados)); 

  try {
    await fetch(URL_GOOGLE_FORMS, { 
      method: "POST", 
      body: formData, 
      mode: "no-cors" 
    });
    
    btnSubmit.textContent = "✅ ¡Enviado!";
    btnSubmit.style.background = "green";
    
    // Opcional: Redirigir o limpiar
    setTimeout(() => {
       alert("Datos de obras registrados correctamente.");
       // window.location.reload(); 
    }, 500);

  } catch(error) {
    alert("❌ Error al enviar formulario: " + error.message);
    btnSubmit.disabled = false;
    btnSubmit.textContent = originalText;
  }
});

</script>
</body>
</html>